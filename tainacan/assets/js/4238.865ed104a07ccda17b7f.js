"use strict";(self.webpackChunktainacan=self.webpackChunktainacan||[]).push([[4238],{15295(t,e,a){var i=a(85072),n=a.n(i),o=a(97825),d=a.n(o),r=a(77659),l=a.n(r),u=a(55056),s=a.n(u),m=a(10540),c=a.n(m),p=a(63494),g=a.n(p),h=a(64276),f={};f.styleTagTransform=g(),f.setAttributes=s(),f.insert=l().bind(null,"head"),f.domAPI=d(),f.insertStyleElement=c();n()(h.A,f),h.A&&h.A.locals&&h.A.locals},18400(t,e,a){a(15295)},19559(t,e,a){a.d(e,{X:()=>l});var i=a(6934);function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=Array(e);a<e;a++)i[a]=t[a];return i}var d=["id"],r={class:"geocoordinate-input-panel"};function l(t,e,a,o,l,u){var s=(0,i.g2)("l-tile-layer"),m=(0,i.g2)("b-input"),c=(0,i.g2)("b-button"),p=(0,i.g2)("l-control"),g=(0,i.g2)("l-marker"),h=(0,i.g2)("l-tooltip"),f=(0,i.g2)("l-icon"),_=(0,i.g2)("l-map");return(0,i.uX)(),(0,i.CE)("div",{id:u.itemMetadatumIdentifier,class:"tainacan-leaflet-map-container"},[(0,i.bF)(_,{id:"map--"+u.itemMetadatumIdentifier,ref:"map--"+u.itemMetadatumIdentifier,style:{height:"320px",width:"100%","min-width":"320px"},zoom:u.initialZoom,"max-zoom":u.maxZoom,center:[u.initialLatitude,u.initialLongitude],"zoom-animation":!0,options:{name:"map--"+u.itemMetadatumIdentifier,trackResize:!1,worldCopyJump:!0},onClick:u.onMapClick},{default:(0,i.k6)((function(){return[(0,i.bF)(s,{url:u.mapProvider,attribution:u.attribution},null,8,["url","attribution"]),(0,i.bF)(p,{position:"topright"},{default:(0,i.k6)((function(){return[(0,i.Lk)("div",r,[l.editingMarkerIndex>=0?((0,i.uX)(),(0,i.Wv)(m,{key:0,expanded:"",placeholder:-14.408656999999,type:"text",step:1e-12,"model-value":l.latitude,"onUpdate:modelValue":u.onUpdateFromLatitudeInput},null,8,["model-value","onUpdate:modelValue"])):(0,i.Q3)("",!0),l.editingMarkerIndex>=0?((0,i.uX)(),(0,i.Wv)(m,{key:1,expanded:"",placeholder:-51.316689999999,type:"text",step:1e-12,"model-value":l.longitude,"onUpdate:modelValue":u.onUpdateFromLongitudeInput},null,8,["model-value","onUpdate:modelValue"])):(0,i.Q3)("",!0),l.editingMarkerIndex>=0?((0,i.uX)(),(0,i.Wv)(c,{key:2,outlined:"",onClick:e[0]||(e[0]=function(t){return u.onMarkerRemove(l.editingMarkerIndex)})},{default:(0,i.k6)((function(){return[e[5]||(e[5]=(0,i.Lk)("span",{"aria-hidden":"true",class:"icon is-small"},[(0,i.Lk)("i",{class:"tainacan-icon has-text-secondary tainacan-icon-remove"})],-1)),(0,i.eW)("  "+(0,i.v_)(t.$i18n.get("remove_point")),1)]})),_:1})):(0,i.Q3)("",!0),l.editingMarkerIndex<0&&u.shouldAddMore?((0,i.uX)(),(0,i.Wv)(c,{key:3,outlined:"",onClick:e[1]||(e[1]=function(t){return u.addLocation(l.latitude+","+l.longitude)})},{default:(0,i.k6)((function(){return[e[6]||(e[6]=(0,i.Lk)("span",{"aria-hidden":"true",class:"icon is-small"},[(0,i.Lk)("i",{class:"tainacan-icon has-text-secondary tainacan-icon-add"})],-1)),(0,i.eW)("  "+(0,i.v_)(t.$i18n.get("add")),1)]})),_:1})):(0,i.Q3)("",!0)])]})),_:1}),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(u.selectedLatLng,(function(t,a){return(0,i.uX)(),(0,i.Wv)(g,{key:a,draggable:!0,"lat-lng":t,opacity:l.editingMarkerIndex>=0&&l.editingMarkerIndex!=a?.35:1,onDragend:function(t){return u.onDragMarker(t,a)},onClick:e[2]||(e[2]=function(t){return u.onMarkerEditingClick(t)})},null,8,["lat-lng","opacity","onDragend"])})),128)),u.editingLatLng&&l.editingMarkerIndex<0&&u.shouldAddMore?((0,i.uX)(),(0,i.Wv)(g,{key:0,draggable:!0,"lat-lng":u.editingLatLng,onDragend:e[3]||(e[3]=function(t){return u.onDragEditingMarker(t)}),onClick:e[4]||(e[4]=function(t){return u.addLocation(l.latitude+","+l.longitude)})},{default:(0,i.k6)((function(){return[(0,i.bF)(h,{options:{offset:[16,0]}},{default:(0,i.k6)((function(){return[(0,i.eW)((0,i.v_)(t.$i18n.get("instruction_click_to_add_a_point")),1)]})),_:1}),(0,i.bF)(f,{"class-name":"tainacan-location-marker-add"},{default:(0,i.k6)((function(){return n(e[7]||(e[7]=[(0,i.Lk)("span",{class:"icon"},[(0,i.Lk)("i",{class:"tainacan-icon has-text-secondary tainacan-icon-add"})],-1)]))})),_:1})]})),_:1},8,["lat-lng"])):(0,i.Q3)("",!0)]})),_:1},8,["id","zoom","max-zoom","center","options","onClick"])],8,d)}},41741(t,e,a){a.d(e,{A:()=>u});var i=a(6934),n=a(68061),o=(a(79997),a(53481)),d=a(76210),r=a(68299),l=a(6993);delete o.Icon.Default.prototype._getIconUrl,o.Icon.Default.mergeOptions({iconRetinaUrl:r.default,iconUrl:d.default,shadowUrl:l.default});const u={components:{LMap:n.Do,LIcon:n.up,LTooltip:n.KV,LTileLayer:n.a,LMarker:n.li,LControl:n.cZ},props:{itemMetadatum:Object,value:[String,Array],disabled:!1,maxtags:"",isLastMetadatum:!1},emits:["update:value"],data:function(){return{editingMarkerIndex:-1,latitude:-14.4086569,longitude:-51.31668,selected:[],mapIntersectionObserver:null}},computed:{mapProvider:function(){return this.itemMetadatum&&this.itemMetadatum.metadatum.metadata_type_options&&this.itemMetadatum.metadatum.metadata_type_options.map_provider?this.itemMetadatum.metadatum.metadata_type_options.map_provider:"https://tile.openstreetmap.org/{z}/{x}/{y}.png"},initialZoom:function(){return this.itemMetadatum&&this.itemMetadatum.metadatum.metadata_type_options&&this.itemMetadatum.metadatum.metadata_type_options.initial_zoom?Number(this.itemMetadatum.metadatum.metadata_type_options.initial_zoom):5},maxZoom:function(){return this.itemMetadatum&&this.itemMetadatum.metadatum.metadata_type_options&&this.itemMetadatum.metadatum.metadata_type_options.maximum_zoom?this.itemMetadatum.metadatum.metadata_type_options.maximum_zoom:12},initialLatitude:function(){return this.itemMetadatum&&this.itemMetadatum.metadatum.metadata_type_options&&this.itemMetadatum.metadatum.metadata_type_options.initial_latitude?Number(this.itemMetadatum.metadatum.metadata_type_options.initial_latitude):-14.4086569},initialLongitude:function(){return this.itemMetadatum&&this.itemMetadatum.metadatum.metadata_type_options&&this.itemMetadatum.metadatum.metadata_type_options.initial_longitude?Number(this.itemMetadatum.metadatum.metadata_type_options.initial_longitude):-51.31668},attribution:function(){return this.itemMetadatum&&this.itemMetadatum.metadatum.metadata_type_options&&this.itemMetadatum.metadatum.metadata_type_options.attribution?this.itemMetadatum.metadatum.metadata_type_options.attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors'},itemMetadatumIdentifier:function(){return"tainacan-item-metadatum_id-"+this.itemMetadatum.metadatum.id+(this.itemMetadatum.parent_meta_id?"_parent_meta_id-"+this.itemMetadatum.parent_meta_id:"")},selectedLatLng:function(){var t=this;return this.selected&&Array.isArray(this.selected)?this.selected.filter((function(e){var a=e.indexOf(",")&&2==e.split(",").length?e.split(","):[t.initialLatitude,t.initialLongitude];return!isNaN(Number(a[0]))&&!isNaN(Number(a[1]))})).map((function(e){var a=e.indexOf(",")&&2==e.split(",").length?e.split(","):[t.initialLatitude,t.initialLongitude];return(0,o.latLng)(Number(a[0]),Number(a[1]))})):[]},editingLatLng:function(){return isNaN(this.latitude)||isNaN(this.longitude)?null:(0,o.latLng)(Number(this.latitude),Number(this.longitude))},maxMultipleValues:function(){return this.itemMetadatum&&this.itemMetadatum.metadatum&&this.itemMetadatum.metadatum.cardinality&&!isNaN(this.itemMetadatum.metadatum.cardinality)&&this.itemMetadatum.metadatum.cardinality>1?this.itemMetadatum.metadatum.cardinality:void 0},shouldAddMore:function(){var t=null!=this.maxtags?this.maxtags:"yes"==this.itemMetadatum.metadatum.multiple?void 0!==this.maxMultipleValues?this.maxMultipleValues:null:"1";return null===t||this.selected.length<t}},watch:{selectedLatLng:{handler:function(){var t=this,e="map--"+this.itemMetadatumIdentifier;(0,i.dY)((function(){t.$refs[e]&&t.$refs[e].leafletObject&&null!=t.selectedLatLng.length&&(1==t.selectedLatLng.length?t.$refs[e].leafletObject.panInsideBounds(t.selectedLatLng,{animate:!0,maxZoom:t.maxZoom}):t.$refs[e].leafletObject.flyToBounds(t.selectedLatLng,{animate:!0,maxZoom:t.maxZoom}))}))},deep:!0}},created:function(){this.value&&""!=this.value&&(this.selected=Array.isArray(this.value)?1==this.value.length&&""==this.value[0]?[]:this.value:[this.value])},mounted:function(){var t=this;(0,i.dY)((function(){var e="map--"+t.itemMetadatumIdentifier;t.handleWindowResize(e),t.selected&&0!==t.selected.length||(t.latitude=t.initialLatitude,t.longitude=t.initialLongitude),t.$refs[e]&&t.$refs[e].$el&&(t.mapIntersectionObserver=new IntersectionObserver((function(a){a.forEach((function(a){a.isIntersecting&&t.handleWindowResize(e)}))}),{threshold:.1}),t.mapIntersectionObserver.observe(t.$refs[e].$el))}))},methods:{onUpdateFromLatitudeInput:_.debounce((function(t){var e=t;if(isNaN(e)){var a=e.split(",");!a||2!=a.length||isNaN(a[0])||isNaN(a[1])||(this.latitude=a[0],this.longitude=a[1],this.onUpdateFromLatitudeAndLongitude())}else this.latitude=e,this.onUpdateFromLatitudeAndLongitude()}),250),onUpdateFromLongitudeInput:_.debounce((function(t){var e=t;if(isNaN(e)){var a=e.split(",");!a||2!=a.length||isNaN(a[0])||isNaN(a[1])||(this.latitude=a[0],this.longitude=a[1],this.onUpdateFromLatitudeAndLongitude())}else this.longitude=e,this.onUpdateFromLatitudeAndLongitude()}),250),onUpdateFromLatitudeAndLongitude:function(){this.editingMarkerIndex>=0&&(this.selected.splice(this.editingMarkerIndex,1,this.latitude+","+this.longitude),this.$emit("update:value",this.selected))},onDragMarker:function(t,e){t.target&&t.target._latlng&&(this.editingMarkerIndex==e&&(this.latitude=t.target._latlng.lat,this.longitude=t.target._latlng.lng),this.selected.splice(e,1,t.target._latlng.lat+","+t.target._latlng.lng),this.$emit("update:value",this.selected))},onDragEditingMarker:function(t){t.target&&t.target._latlng&&(this.latitude=t.target._latlng.lat,this.longitude=t.target._latlng.lng)},onMapClick:function(t){this.editingMarkerIndex=-1,t&&t.latlng&&(this.latitude=t.latlng.lat,this.longitude=t.latlng.lng)},onMarkerAdd:function(t){if(this.editingMarkerIndex=-1,t.latlng&&this.shouldAddMore){var e=t.latlng.lat+","+t.latlng.lng;this.addLocation(e)}},addLocation:function(t){this.selected.indexOf(t)<0&&(this.selected.push(t),this.$emit("update:value",this.selected),this.editingMarkerIndex=this.selected.length-1)},onMarkerEditingClick:function(t){if(t.target&&t.target._latlng){this.latitude=t.target._latlng.lat,this.longitude=t.target._latlng.lng;var e=this.selected.indexOf(this.latitude+","+this.longitude);this.editingMarkerIndex=e;var a="map--"+this.itemMetadatumIdentifier;this.$refs[a]&&this.$refs[a].leafletObject&&this.$refs[a].leafletObject.panInsideBounds([this.selectedLatLng[e]],{animate:!0,maxZoom:this.maxZoom})}},onMarkerRemove:function(t){this.editingMarkerIndex=-1,this.latitude=this.selectedLatLng[t].lat,this.longitude=this.selectedLatLng[t].lng,this.selected.splice(t,1),this.$emit("update:value",this.selected)},handleWindowResize:function(t){var e=this;setTimeout((function(){e.$refs[t]&&e.$refs[t].leafletObject&&(e.$refs[t].leafletObject.invalidateSize(!0),null!=e.selectedLatLng.length&&(1==e.selectedLatLng.length?e.$refs[t].leafletObject.panInsideBounds(e.selectedLatLng,{animate:!0,maxZoom:e.maxZoom}):e.$refs[t].leafletObject.flyToBounds(e.selectedLatLng,{animate:!0,maxZoom:e.maxZoom})))}),500)}}}},64276(t,e,a){a.d(e,{A:()=>r});var i=a(31601),n=a.n(i),o=a(76314),d=a.n(o)()(n());d.push([t.id,".tainacan-leaflet-map-container .leaflet-container{border:1px solid var(--tainacan-input-border-color);border-radius:var(--tainacan-input-border-radius, 3px);z-index:0}.tainacan-leaflet-map-container .leaflet-container .leaflet-marker-pane{filter:hue-rotate(-22deg)}.tainacan-leaflet-map-container .leaflet-container .tainacan-location-marker-add{padding:1rem;background:hsla(0,0%,100%,.7);border:2px solid var(--tainacan-secondary);display:flex;align-items:center;justify-content:center;border-radius:100%;font-size:.875rem;margin-left:-1.125rem !important;margin-top:-1.125rem !important}.tainacan-leaflet-map-container .leaflet-container .geocoordinate-input-panel{padding:0px;margin:0px;display:flex;align-items:stretch;font-size:1rem}.tainacan-leaflet-map-container .leaflet-container .geocoordinate-input-panel>.field,.tainacan-leaflet-map-container .leaflet-container .geocoordinate-input-panel>.field>.field-body{padding:0px;margin:0px}.tainacan-leaflet-map-container .leaflet-container .geocoordinate-input-panel .control{width:100%}.tainacan-leaflet-map-container .leaflet-container .geocoordinate-input-panel .button:not(.is-small):not(.is-medium):not(.is-large){color:var(--tainacan-secondary);border-radius:0px !important;height:100% !important;line-height:1.7rem;background-color:var(--tainacan-input-background-color, #fff) !important}",""]);const r=d},75676(t,e,a){a.d(e,{A:()=>i.A});var i=a(41741)},95170(t,e,a){a.d(e,{X:()=>i.X});var i=a(19559)}}]);