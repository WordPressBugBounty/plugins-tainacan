"use strict";(self.webpackChunktainacan=self.webpackChunktainacan||[]).push([[9741],{19741(t,e,i){i.r(e),i.d(e,{default:()=>o});var n=i(65935),a=i(75370);i(44327);const o=(0,i(66262).A)(a.A,[["render",n.X]])},27493(t,e,i){i.d(e,{A:()=>c});var n=i(40834),a=i(6934);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function r(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return d(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?d(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var _n=0,n=function(){};return{s:n,n:function(){return _n>=t.length?{done:!0}:{done:!1,value:t[_n++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,r=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){r=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(r)throw a}}}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){u(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function u(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const c={name:"BulkEditionModal",components:{TainacanText:(0,a.$V)((function(){return Promise.all([i.e(554),i.e(4066)]).then(i.bind(i,11685))})),TainacanTextarea:(0,a.$V)((function(){return i.e(9588).then(i.bind(i,37207))})),TainacanSelectbox:(0,a.$V)((function(){return i.e(5724).then(i.bind(i,93343))})),TainacanNumeric:(0,a.$V)((function(){return i.e(2832).then(i.bind(i,60451))})),TainacanDate:(0,a.$V)((function(){return Promise.all([i.e(8901),i.e(554),i.e(7605)]).then(i.bind(i,40507))})),TainacanRelationship:(0,a.$V)((function(){return Promise.all([i.e(6484),i.e(600)]).then(i.bind(i,98219))})),TainacanTaxonomy:(0,a.$V)((function(){return Promise.all([i.e(3709),i.e(7158)]).then(i.bind(i,14777))})),TainacanCompound:(0,a.$V)((function(){return Promise.all([i.e(3704),i.e(9370)]).then(i.bind(i,56989))})),TainacanUser:(0,a.$V)((function(){return i.e(7290).then(i.bind(i,24909))})),TainacanGeocoordinate:(0,a.$V)((function(){return Promise.all([i.e(5218),i.e(8061),i.e(4238),i.e(420)]).then(i.bind(i,29863))})),TainacanUrl:(0,a.$V)((function(){return i.e(2144).then(i.bind(i,39763))}))},props:{modalTitle:String,totalItems:Number,objectType:String,selectedForBulk:Object,collectionId:[String,Number]},emits:["close"],data:function(){return{editionCriteria:[1],editionActions:{add:this.$i18n.get("add_value"),redefine:this.$i18n.get("set_new_value"),replace:this.$i18n.get("replace_value"),remove:this.$i18n.get("remove_a_value"),clear:this.$i18n.get("clear_values"),copy:this.$i18n.get("copy_value")},bulkEditionProcedures:{1:{isDone:!1,isExecuting:!1,totalItemsEditedWithSuccess:0,tooltipShow:!0}},groupId:null,dones:[!1],metadataIsLoading:!1,metadataSearchCancel:void 0,selectedUserId:"",users:[],isFetchingUsers:!1,usersPage:1,usersPerPage:10,usersTotal:0,usersTotalPages:0,usersSearch:""}},computed:s({},(0,n.L8)("metadata",{metadata:"getMetadata"})),created:function(){var t=this;this.collectionId&&(this.metadataIsLoading=!0,null!=this.metadataSearchCancel&&this.metadataSearchCancel.cancel("Metadata search Canceled."),this.fetchMetadata({collectionId:this.collectionId,isRepositoryLevel:!1,isContextEdit:!0,includeDisabled:!1,parent:"any"}).then((function(e){e.request.then((function(){t.metadataIsLoading=!1})).catch((function(){t.metadataIsLoading=!1})),t.metadataSearchCancel=e.source})).catch((function(){return t.metadataIsLoading=!1}))),this.createEditGroup({object:this.selectedForBulk,collectionId:this.collectionId?this.collectionId:"default"}).then((function(){t.groupId=t.getGroupId()}))},mounted:function(){this.$refs.bulkEditionModal&&this.$refs.bulkEditionModal.focus()},beforeUnmount:function(){null!=this.metadataSearchCancel&&this.metadataSearchCancel.cancel("Metadata search Canceled.")},methods:s(s(s(s(s({},(0,n.L8)("bulkedition",["getGroupId"])),(0,n.i0)("bulkedition",["createEditGroup","setValueInBulk","clearValuesInBulk","addValueInBulk","replaceValueInBulk","redefineValueInBulk","setStatusInBulk","setAuthorIdInBulk","setCommentStatusInBulk","removeValueInBulk","copyValuesInBulk"])),(0,n.i0)("metadata",["fetchMetadata"])),(0,n.i0)("activity",["fetchUsers"])),{},{finalizeProcedure:function(t){Object.assign(this.bulkEditionProcedures[t],{isDone:!0}),this.dones[this.editionCriteria.indexOf(t)]=!0,Object.assign(this.bulkEditionProcedures[t],{isExecuting:!1})},executeBulkEditionProcedure:function(t){var e=this,i=this.bulkEditionProcedures[t];i.action===this.editionActions.redefine?(Object.assign(this.bulkEditionProcedures[t],{isExecuting:!0}),"status"===i.metadatum.id?this.setStatusInBulk({collectionId:this.collectionId,groupId:this.groupId,bodyParams:{value:i.newValue}}).then((function(){e.finalizeProcedure(t)})):"author_id"===i.metadatum.id?this.setAuthorIdInBulk({collectionId:this.collectionId,groupId:this.groupId,bodyParams:{value:i.newValue}}).then((function(){e.finalizeProcedure(t)})):"comments"===i.metadatum.id?this.setCommentStatusInBulk({collectionId:this.collectionId,groupId:this.groupId,bodyParams:{value:i.newValue}}).then((function(){e.finalizeProcedure(t)})):this.setValueInBulk({collectionId:this.collectionId,groupId:this.groupId,bodyParams:{metadatum_id:i.metadatum.id,value:i.newValue}}).then((function(){e.finalizeProcedure(t)}))):i.action===this.editionActions.add?(Object.assign(this.bulkEditionProcedures[t],{isExecuting:!0}),this.addValueInBulk({collectionId:this.collectionId,groupId:this.groupId,bodyParams:{metadatum_id:i.metadatum.id,value:i.newValue}}).then((function(){e.finalizeProcedure(t)}))):i.action===this.editionActions.replace?(Object.assign(this.bulkEditionProcedures[t],{isExecuting:!0}),this.replaceValueInBulk({collectionId:this.collectionId,groupId:this.groupId,bodyParams:{metadatum_id:i.metadatum.id,old_value:i.oldValue,new_value:i.newValue}}).then((function(){e.finalizeProcedure(t)}))):i.action===this.editionActions.remove?(Object.assign(this.bulkEditionProcedures[t],{isExecuting:!0}),this.removeValueInBulk({collectionId:this.collectionId,groupId:this.groupId,bodyParams:{metadatum_id:i.metadatum.id,value:i.newValue}}).then((function(){e.finalizeProcedure(t)}))):i.action===this.editionActions.clear?(Object.assign(this.bulkEditionProcedures[t],{isExecuting:!0}),this.clearValuesInBulk({collectionId:this.collectionId,groupId:this.groupId,bodyParams:{metadatum_id:i.metadatum.id}}).then((function(){e.finalizeProcedure(t)}))):i.action===this.editionActions.copy&&(Object.assign(this.bulkEditionProcedures[t],{isExecuting:!0}),this.copyValuesInBulk({collectionId:this.collectionId,groupId:this.groupId,bodyParams:{metadatum_id_to:parseInt(i.metadatum.id),metadatum_id_from:i.metadatumIdCopyFrom}}).then((function(){e.finalizeProcedure(t)})))},addEditionCriterion:function(){var t=Math.floor(999*Math.random())+2;null==this.editionCriteria.find((function(e){return e==t}))?(this.editionCriteria.push(t),this.bulkEditionProcedures=Object.assign({},this.bulkEditionProcedures,u({},"".concat(t),{isDone:!1,isExecuting:!1,totalItemsEditedWithSuccess:0,tooltipShow:!0})),this.dones.push(!1)):this.addEditionCriterion()},removeThis:function(t){var e=this.editionCriteria.findIndex((function(e){return e==t}));this.editionCriteria[e]&&(this.editionCriteria.splice(e,1),delete this.bulkEditionProcedures[t],this.dones.splice(e,1))},getValidEditionActions:function(t){for(var e=JSON.parse(JSON.stringify(this.editionActions)),i=0,n=Object.keys(this.editionActions);i<n.length;i++){var a=n[i];if("yes"==t.multiple||"add"!=a&&"replace"!=a&&"remove"!=a)if("status"!=t.id&&"author_id"!=t.id&&"comments"!=t.id||"clear"!=a&&"copy"!=a){if("copy"==a&&t.metadata_type_object)(this.metadata.findIndex((function(e){return e.id!=t.id&&e.metadata_type_object.component==t.metadata_type_object.component&&e.parent<=0}))<0&&"tainacan-user"!=t.metadata_type_object.component||t.parent>0)&&delete e[a]}else delete e[a];else delete e[a]}return e},getAllowedMetadataForCopy:function(t){if(this.bulkEditionProcedures[t]&&this.bulkEditionProcedures[t].metadatum&&this.bulkEditionProcedures[t].action&&this.bulkEditionProcedures[t].action==this.editionActions.copy){var e=this.bulkEditionProcedures[t].metadatum;if(e.metadata_type_object&&e.metadata_type)return JSON.parse(JSON.stringify(this.metadata)).filter((function(t){return t.id!=e.id&&t.metadata_type==e.metadata_type&&("yes"==e.multiple||"yes"!=t.multiple&&"yes"!=e.multiple)}))}return[]},addToBulkEditionProcedures:function(t,e,i){Array.isArray(t)&&(t=t[0]),Object.assign(this.bulkEditionProcedures[i],u({},"".concat(e),t)),"metadatum"===e&&this.bulkEditionProcedures[i].metadatum&&1===Object.values(this.getValidEditionActions(this.bulkEditionProcedures[i].metadatum)).length&&Object.assign(this.bulkEditionProcedures[i],{action:Object.values(this.getValidEditionActions(this.bulkEditionProcedures[i].metadatum))[0]})},fetchUsersForAuthor:_.debounce((function(t){var e=this;t!=this.usersSearch&&(this.usersSearch=t,this.users=[],this.usersPage=1),t.length||(this.usersSearch=t,this.users=[],this.usersPage=1),this.usersPage>1&&this.users.length>this.totalUsers||(this.isFetchingUsers=!0,this.fetchUsers({search:this.usersSearch,page:this.usersPage}).then((function(t){if(t.users){var i,n=r(t.users);try{for(n.s();!(i=n.n()).done;){var a=i.value;e.users.push(a)}}catch(t){n.e(t)}finally{n.f()}}t.totalUsers&&(e.totalUsers=t.totalUsers),e.usersPage++,e.isFetchingUsers=!1})).catch((function(t){e.$console.error(t),e.isFetchingUsers=!1})))}),500),fetchMoreUsersForAuthor:_.debounce((function(){this.fetchUsersForAuthor(this.usersSearch)}),250),onFinish:function(){var t=this;this.$buefy.snackbar.open({message:this.$i18n.get("info_bulk_edit_process_added"),type:"is-primary",duration:4e3,actionText:this.$i18n.get("label_view_processes"),onAction:function(){t.$router.push(t.$routerHelper.getProcessesPath())}}),this.$eventBusSearch.loadItems(),this.$emit("close")}})}},36555(t,e,i){i.d(e,{A:()=>d});var n=i(31601),a=i.n(n),o=i(76314),r=i.n(o)()(a());r.push([t.id,"@media screen and (max-width: 768px){.tainacan-bulk-edition-inline-fields{flex-direction:column !important}.tainacan-bulk-edition-inline-fields .tainacan-bulk-edition-field:not(:first-child){padding-inline-start:0 !important}.tainacan-bulk-edition-inline-fields .bulk-last-field{margin-inline-start:0 !important;justify-content:center !important}}.this-tainacan-modal-content{min-height:276px}.this-tainacan-modal-content .button.is-white.is-loading{cursor:inherit;color:var(--tainacan-gray4) !important}.this-tainacan-modal-content .is-pulled-right .is-success{background-color:rgba(0,0,0,0) !important}.this-tainacan-modal-content .add-link{font-size:.875em}.this-tainacan-modal-content .form-submit{padding:42px 0 0 0 !important}.no-overflow-modal-card-body{padding:0 !important;overflow:unset !important}.tainacan-total-objects-info{font-size:.75em;font-weight:normal}.tainacan-by-text{max-width:28px}.tainacan-bulk-edition-inline-fields{display:inline-flex;flex-direction:row;flex-wrap:wrap;width:100%;padding-right:.75rem}.tainacan-bulk-edition-inline-fields .control .select{width:100% !important}.tainacan-bulk-edition-inline-fields .control .select select{width:100% !important}.tainacan-bulk-edition-inline-fields .taginput-container .tags{margin-bottom:calc(.275em - 1px) !important}.tainacan-bulk-edition-inline-fields .taginput-container .tags .tag{height:2em !important;padding-left:.75em !important;padding-right:.75em !important;margin-right:0 !important}.tainacan-bulk-edition-inline-fields .taginput-container .icon{height:28px !important}.tainacan-bulk-edition-inline-fields .is-field-history .input[disabled],.tainacan-bulk-edition-inline-fields .is-field-history .taginput [disabled].taginput-container.is-focusable,.tainacan-bulk-edition-inline-fields .is-field-history .textarea[disabled]{color:var(--tainacan-black) !important;border:none !important;background-color:var(--tainacan-input-background-color) !important}.tainacan-bulk-edition-inline-fields .is-field-history .taginput-container .tags{color:var(--tainacan-black) !important;background-color:var(--tainacan-white) !important;border:none !important}.tainacan-bulk-edition-inline-fields .is-field-history .taginput-container .tags .tag.is-delete{display:none !important}.tainacan-bulk-edition-inline-fields .is-field-history .taginput-container .tags .tag{max-width:100% !important}.tainacan-bulk-edition-inline-fields .is-field-history .taginput-container .tags:hover,.tainacan-bulk-edition-inline-fields .is-field-history .taginput-container .tags .tag{background-color:var(--tainacan-white) !important}.tainacan-bulk-edition-inline-fields .is-field-history .taginput-container .icon{display:none !important}.tainacan-bulk-edition-inline-fields .is-field-history input{color:var(--tainacan-black) !important;border:none !important;background-color:var(--tainacan-white) !important}.tainacan-bulk-edition-inline-fields .is-field-history textarea{color:var(--tainacan-black) !important;border:none !important;background-color:var(--tainacan-white) !important;min-height:auto !important;line-height:1.5em}.tainacan-bulk-edition-inline-fields .is-field-history .select:after{display:none !important}.tainacan-bulk-edition-inline-fields .is-field-history .select select{border:none !important}.tainacan-bulk-edition-inline-fields .tainacan-bulk-edition-field{flex-grow:1;flex-shrink:1;padding-bottom:9px;flex-basis:10%}.tainacan-bulk-edition-inline-fields .tainacan-bulk-edition-field:not(:first-child){padding-left:13px !important}.tainacan-bulk-edition-inline-fields .tainacan-bulk-edition-field .is-special-hidden-for-mobile,.tainacan-bulk-edition-inline-fields .tainacan-bulk-edition-field .is-special-hidden-for-mobile:focus,.tainacan-bulk-edition-inline-fields .tainacan-bulk-edition-field .is-special-hidden-for-mobile:focus-visible{opacity:0;width:0;height:0 !important;min-height:0;min-width:0;padding:0 !important;line-height:0px !important;border:none !important;border-color:rgba(0,0,0,0) !important;border-width:0px !important;font-size:0px !important;display:block !important}.tainacan-bulk-edition-inline-fields .bulk-last-field{display:flex;align-items:center;height:32px;margin-inline-start:10px;flex-direction:row-reverse}.tainacan-bulk-edition-inline-fields .bulk-last-field .icon.has-text-dark:hover{color:var(--tainacan-heading-color) !important}.tainacan-add-edition-criterion-button{font-size:.75em;color:var(--tainacan-turquoise5)}.tainacan-add-edition-criterion-button-disabled{cursor:not-allowed !important}",""]);const d=r},44327(t,e,i){i(61018)},61018(t,e,i){var n=i(85072),a=i.n(n),o=i(97825),r=i.n(o),d=i(77659),l=i.n(d),s=i(55056),u=i.n(s),c=i(10540),m=i.n(c),b=i(63494),p=i.n(b),h=i(36555),f={};f.styleTagTransform=p(),f.setAttributes=u(),f.insert=l().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=m();a()(h.A,f),h.A&&h.A.locals&&h.A.locals},65935(t,e,i){i.d(e,{X:()=>n.X});var n=i(84308)},75370(t,e,i){i.d(e,{A:()=>n.A});var n=i(27493)},84308(t,e,i){i.d(e,{X:()=>W});var n=i(6934);function a(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}var r={ref:"bulkEditionModal","aria-labelledby":"alert-dialog-title",autofocus:"",role:"alertdialog",tabindex:"-1","aria-modal":"",class:"tainacan-modal-content this-tainacan-modal-content"},d={class:"tainacan-modal-title"},l={class:"tainacan-total-objects-info"},s=["aria-label"],u={class:"tainacan-form"},c={class:"modal-card-body no-overflow-modal-card-body"},m=["value"],b=["label"],p=["value"],h=["label"],f={value:{id:"status"}},k={value:{id:"author_id"}},g={value:{id:"comments"}},y=["value"],E={key:0,style:{"margin-left":"12px",display:"flex"}},v={class:"tainacan-bulk-edition-field tainacan-bulk-edition-field-not-last tainacan-by-text"},P=["value"],_={class:"media"},I={key:0,class:"media-left"},C=["src"],w={class:"media-content"},x=["value"],j=["value"],S=["label"],$=["value"],A={key:0,value:"created_by"},V=["onClick"],F={class:"icon"},X=["onMouseover"],O={class:"icon"},L=["disabled","onClick"],U={class:"icon"},T={key:3},B=["disabled"],D={class:"field is-grouped form-submit"},M={class:"control"},Q=["disabled"],z={class:"control"},K=["disabled"];function W(t,e,i,o,W,N){var H=(0,n.g2)("b-select"),G=(0,n.g2)("b-autocomplete"),J=(0,n.gN)("tooltip");return(0,n.uX)(),(0,n.CE)("div",r,[(0,n.Lk)("header",d,[(0,n.Lk)("h2",null,[(0,n.eW)((0,n.v_)(i.modalTitle)+" ",1),(0,n.Lk)("small",l,(0,n.v_)("(".concat(i.totalItems," ").concat(i.objectType,")")),1)]),(0,n.Lk)("button",{class:"button is-medium is-white is-align-self-flex-start","aria-label":t.$i18n.get("close"),onClick:e[0]||(e[0]=function(e){return t.$emit("close")})},a(e[7]||(e[7]=[(0,n.Lk)("span",{"aria-hidden":"true",class:"icon"},[(0,n.Lk)("i",{class:"tainacan-icon tainacan-icon-close tainacan-icon-1-125em"})],-1)])),8,s)]),(0,n.Lk)("div",u,[(0,n.Lk)("div",c,[(0,n.bF)(n.F,{name:"filter-item"},{default:(0,n.k6)((function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(W.editionCriteria,(function(i){return(0,n.uX)(),(0,n.CE)("div",{key:i,class:"tainacan-bulk-edition-inline-fields"},[(0,n.bF)(H,{loading:W.metadataIsLoading,class:(0,n.C4)([{"is-field-history":W.bulkEditionProcedures[i].isDone,"hidden-select-arrow":!!W.bulkEditionProcedures[i].metadatum},"tainacan-bulk-edition-field tainacan-bulk-edition-field-not-last"]),disabled:!!W.bulkEditionProcedures[i].metadatum||W.metadataIsLoading,placeholder:t.$i18n.get("instruction_select_a_metadatum"),"inherit-attrs":"false","onUpdate:modelValue":function(t){return N.addToBulkEditionProcedures(t,"metadatum",i)}},{default:(0,n.k6)((function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.metadata,(function(t,e){return(0,n.uX)(),(0,n.CE)(n.FK,{key:e},[t.id&&"tainacan-compound"!==t.metadata_type_object.component&&t.parent<=0?((0,n.uX)(),(0,n.CE)("option",{key:0,value:t},(0,n.v_)(t.name),9,m)):(0,n.Q3)("",!0),t.id&&"tainacan-compound"===t.metadata_type_object.component&&"yes"!==t.multiple?((0,n.uX)(),(0,n.CE)("optgroup",{key:1,label:t.name},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.metadata_type_options.children_objects,(function(t,e){return(0,n.uX)(),(0,n.CE)(n.FK,{key:e},[t.id?((0,n.uX)(),(0,n.CE)("option",{key:0,value:t},(0,n.v_)(t.name),9,p)):(0,n.Q3)("",!0)],64)})),128))],8,b)):(0,n.Q3)("",!0)],64)})),128)),(0,n.Lk)("optgroup",{label:t.$i18n.get("label_publication_data")},[(0,n.Lk)("option",f,(0,n.v_)(t.$i18n.get("label_status")),1),(0,n.Lk)("option",k,(0,n.v_)(t.$i18n.get("label_authorship")),1),(0,n.Lk)("option",g,(0,n.v_)(t.$i18n.get("label_allow_comments")),1)],8,h)]})),_:1},8,["loading","class","disabled","placeholder","onUpdate:modelValue"]),(0,n.bF)(H,{class:(0,n.C4)([{"is-field-history":W.bulkEditionProcedures[i].isDone,"hidden-select-arrow":!!W.bulkEditionProcedures[i].action},"tainacan-bulk-edition-field tainacan-bulk-edition-field-not-last"]),disabled:!!W.bulkEditionProcedures[i].action||!W.bulkEditionProcedures[i].metadatum,"model-value":W.bulkEditionProcedures[i].action?W.bulkEditionProcedures[i].action:void 0,placeholder:t.$i18n.get("instruction_select_a_action"),"onUpdate:modelValue":function(t){return N.addToBulkEditionProcedures(t,"action",i)}},{default:(0,n.k6)((function(){return[W.bulkEditionProcedures[i].metadatum?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:0},(0,n.pI)(N.getValidEditionActions(W.bulkEditionProcedures[i].metadatum),(function(t,e){return(0,n.uX)(),(0,n.CE)("option",{key:e,value:t},(0,n.v_)(t),9,y)})),128)):(0,n.Q3)("",!0)]})),_:2},1032,["class","disabled","model-value","placeholder","onUpdate:modelValue"]),(0,n.bF)(n.eB,{name:"filter-item"},{default:(0,n.k6)((function(){return[W.bulkEditionProcedures[i]&&W.bulkEditionProcedures[i].metadatum&&W.bulkEditionProcedures[i].action?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[W.bulkEditionProcedures[i].action==W.editionActions.replace?((0,n.uX)(),(0,n.CE)("div",E,[((0,n.uX)(),(0,n.Wv)((0,n.$y)(W.bulkEditionProcedures[i].metadatum.metadata_type_object.component),{"forced-component-type":W.bulkEditionProcedures[i].metadatum.metadata_type_object.component.includes("taxonomy")?"tainacan-taxonomy-tag-input":"","item-metadatum":{metadatum:W.bulkEditionProcedures[i].metadatum},"allow-new":!1,maxtags:1,class:(0,n.C4)([{"is-field-history":W.bulkEditionProcedures[i].isDone},"tainacan-bulk-edition-field"]),disabled:W.bulkEditionProcedures[i].isDone,"onUpdate:value":function(t){return N.addToBulkEditionProcedures(t,"oldValue",i)}},null,40,["forced-component-type","item-metadatum","class","disabled","onUpdate:value"])),(0,n.Lk)("div",v,[(0,n.Lk)("small",null,(0,n.v_)(t.$i18n.get("info_by_inner")),1)]),((0,n.uX)(),(0,n.Wv)((0,n.$y)(W.bulkEditionProcedures[i].metadatum.metadata_type_object.component),{"forced-component-type":W.bulkEditionProcedures[i].metadatum.metadata_type_object.component.includes("taxonomy")?"tainacan-taxonomy-tag-input":"","item-metadatum":{metadatum:W.bulkEditionProcedures[i].metadatum},"allow-new":!1,maxtags:1,class:(0,n.C4)([{"is-field-history":W.bulkEditionProcedures[i].isDone},"tainacan-bulk-edition-field tainacan-bulk-edition-field-not-last"]),disabled:W.bulkEditionProcedures[i].isDone,"onUpdate:value":function(t){return N.addToBulkEditionProcedures(t,"newValue",i)}},null,40,["forced-component-type","item-metadatum","class","disabled","onUpdate:value"]))])):"status"==W.bulkEditionProcedures[i].metadatum.id?((0,n.uX)(),(0,n.Wv)(H,{key:1,class:(0,n.C4)([{"is-field-history":W.bulkEditionProcedures[i].isDone,"hidden-select-arrow":W.bulkEditionProcedures[i].isDone},"tainacan-bulk-edition-field tainacan-bulk-edition-field-last"]),disabled:W.bulkEditionProcedures[i].isDone,placeholder:t.$i18n.get("instruction_select_a_status2"),"onUpdate:modelValue":function(t){return N.addToBulkEditionProcedures(t,"newValue",i)}},{default:(0,n.k6)((function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.$statusHelper.getStatuses().filter((function(t){return"trash"!=t.value})),(function(t,e){return(0,n.uX)(),(0,n.CE)("option",{key:e,value:t.slug},(0,n.v_)(t.name),9,P)})),128))]})),_:1},8,["class","disabled","placeholder","onUpdate:modelValue"])):"author_id"==W.bulkEditionProcedures[i].metadatum.id?((0,n.uX)(),(0,n.Wv)(G,{key:2,class:(0,n.C4)([{"is-field-history":W.bulkEditionProcedures[i].isDone,"hidden-select-arrow":W.bulkEditionProcedures[i].isDone},"tainacan-bulk-edition-field tainacan-bulk-edition-field-last"]),clearable:!W.bulkEditionProcedures[i].isDone,"clear-on-select":!1,data:W.users,placeholder:t.$i18n.get("instruction_type_search_users"),"keep-first":"","open-on-focus":"","append-to-body":!0,loading:W.isFetchingUsers,field:"name",icon:"account",disabled:W.bulkEditionProcedures[i].isDone,"check-infinite-scroll":"","onUpdate:modelValue":e[1]||(e[1]=function(t){return N.fetchUsersForAuthor(t)}),onFocusOnce:N.fetchMoreUsersForAuthor,onSelect:function(t){return N.addToBulkEditionProcedures(t.id,"newValue",i)},onInfiniteScroll:N.fetchMoreUsersForAuthor},(0,n.eX)({default:(0,n.k6)((function(t){return[(0,n.Lk)("div",_,[t.option.avatar_urls&&t.option.avatar_urls[24]?((0,n.uX)(),(0,n.CE)("div",I,[(0,n.Lk)("img",{width:"24",src:t.option.avatar_urls[24]},null,8,C)])):(0,n.Q3)("",!0),(0,n.Lk)("div",w,(0,n.v_)(t.option.name),1)])]})),_:2},[W.isFetchingUsers?void 0:{name:"empty",fn:(0,n.k6)((function(){return[(0,n.eW)((0,n.v_)(t.$i18n.get("info_no_user_found")),1)]})),key:"0"}]),1032,["class","clearable","data","placeholder","loading","disabled","onFocusOnce","onSelect","onInfiniteScroll"])):"comments"==W.bulkEditionProcedures[i].metadatum.id?((0,n.uX)(),(0,n.Wv)(H,{key:3,class:(0,n.C4)([{"is-field-history":W.bulkEditionProcedures[i].isDone,"hidden-select-arrow":W.bulkEditionProcedures[i].isDone},"tainacan-bulk-edition-field tainacan-bulk-edition-field-last"]),disabled:W.bulkEditionProcedures[i].isDone,placeholder:t.$i18n.get("instruction_select_a_comments_status"),"onUpdate:modelValue":function(t){return N.addToBulkEditionProcedures(t,"newValue",i)}},{default:(0,n.k6)((function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.$commentsStatusHelper.getStatuses(),(function(t,e){return(0,n.uX)(),(0,n.CE)("option",{key:e,value:t.slug},(0,n.v_)(t.name),9,x)})),128))]})),_:1},8,["class","disabled","placeholder","onUpdate:modelValue"])):W.bulkEditionProcedures[i].action==W.editionActions.copy?((0,n.uX)(),(0,n.Wv)(H,{key:4,loading:W.metadataIsLoading,class:(0,n.C4)([{"is-field-history":W.bulkEditionProcedures[i].isDone,"hidden-select-arrow":!!W.bulkEditionProcedures[i].metadatumIdCopyFrom},"tainacan-bulk-edition-field tainacan-bulk-edition-field-last"]),disabled:W.bulkEditionProcedures[i].isDone||W.bulkEditionProcedures[i].isExecuting&&!!W.bulkEditionProcedures[i].metadatumIdCopyFrom||W.metadataIsLoading,placeholder:t.$i18n.get("instruction_select_a_metadatum"),"onUpdate:modelValue":function(t){return N.addToBulkEditionProcedures(t,"metadatumIdCopyFrom",i)}},{default:(0,n.k6)((function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(N.getAllowedMetadataForCopy(i),(function(e,i){return(0,n.uX)(),(0,n.CE)(n.FK,{key:i},[e.id&&"tainacan-compound"!==e.metadata_type_object.component&&e.parent<=0?((0,n.uX)(),(0,n.CE)("option",{key:0,value:e.id},(0,n.v_)(e.name),9,j)):(0,n.Q3)("",!0),e.id&&"tainacan-compound"===e.metadata_type_object.component?((0,n.uX)(),(0,n.CE)("optgroup",{key:1,label:e.name},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.metadata_type_options.children_objects,(function(e,i){return(0,n.uX)(),(0,n.CE)(n.FK,{key:i},[t.childMetadatumForCopy.id?((0,n.uX)(),(0,n.CE)("option",{key:0,value:t.childMetadatumForCopy.id},(0,n.v_)(t.childMetadatumForCopy.name),9,$)):(0,n.Q3)("",!0)],64)})),128))],8,S)):(0,n.Q3)("",!0)],64)})),128)),W.bulkEditionProcedures[i].metadatum.metadata_type_object&&"tainacan-user"==W.bulkEditionProcedures[i].metadatum.metadata_type_object.component?((0,n.uX)(),(0,n.CE)("option",A,(0,n.v_)(t.$i18n.get("label_created_by")),1)):(0,n.Q3)("",!0)]})),_:2},1032,["loading","class","disabled","placeholder","onUpdate:modelValue"])):W.bulkEditionProcedures[i].action!=W.editionActions.clear?((0,n.uX)(),(0,n.Wv)((0,n.$y)(W.bulkEditionProcedures[i].metadatum.metadata_type_object.component),{key:5,"forced-component-type":W.bulkEditionProcedures[i].metadatum.metadata_type_object.component.includes("taxonomy")?"tainacan-taxonomy-tag-input":"","item-metadatum":{metadatum:W.bulkEditionProcedures[i].metadatum},"allow-new":!1,maxtags:1,class:(0,n.C4)([{"is-field-history":W.bulkEditionProcedures[i].isDone},"tainacan-bulk-edition-field tainacan-bulk-edition-field-last"]),disabled:W.bulkEditionProcedures[i].isDone||W.bulkEditionProcedures[i].isExecuting,"onUpdate:value":function(t){return N.addToBulkEditionProcedures(t,"newValue",i)}},null,40,["forced-component-type","item-metadatum","class","disabled","onUpdate:value"])):(0,n.Q3)("",!0)],64)):(0,n.Q3)("",!0)]})),_:2},1024),(0,n.Lk)("div",{style:(0,n.Tr)({marginInlineEnd:W.bulkEditionProcedures[i].isDone||W.bulkEditionProcedures[i].isExecuting?0:"-7.4px"}),class:"field bulk-last-field"},[W.bulkEditionProcedures[i].isDone||W.bulkEditionProcedures[i].isExecuting?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("button",{key:0,class:"button is-white is-pulled-right",onClick:function(t){return N.removeThis(i)}},[(0,n.bo)(((0,n.uX)(),(0,n.CE)("span",F,a(e[8]||(e[8]=[(0,n.Lk)("i",{class:"has-text-dark tainacan-icon tainacan-icon-1-25em tainacan-icon-cancel"},null,-1)])))),[[J,{content:t.$i18n.get("remove_bulk_edit"),autoHide:!0,placement:"auto-end",popperClass:["tainacan-tooltip","tooltip"]}]])],8,V)),W.bulkEditionProcedures[i].isDone?((0,n.uX)(),(0,n.CE)("div",{key:1,class:"is-pulled-right",onMouseover:function(t){return Object.assign(W.bulkEditionProcedures[i],{tooltipShow:!W.bulkEditionProcedures[i].tooltipShow})}},[(0,n.bo)(((0,n.uX)(),(0,n.CE)("span",O,a(e[9]||(e[9]=[(0,n.Lk)("i",{class:"has-text-success tainacan-icon tainacan-icon-1-25em tainacan-icon-approvedcircle"},null,-1)])))),[[J,{content:t.$i18n.get("info_bulk_edit_process_added"),autoHide:!0,placement:"auto",popperClass:["tainacan-tooltip","tooltip"],triggers:[],show:W.bulkEditionProcedures[i].tooltipShow}]])],40,X)):(0,n.Q3)("",!0),!W.bulkEditionProcedures[i].isDone&&!W.bulkEditionProcedures[i].isExecuting&&W.bulkEditionProcedures[i].metadatum&&W.bulkEditionProcedures[i].action&&(W.bulkEditionProcedures[i].action!=W.editionActions.copy||W.bulkEditionProcedures[i].action==W.editionActions.copy&&W.bulkEditionProcedures[i].metadatumIdCopyFrom)?((0,n.uX)(),(0,n.CE)("button",{key:2,disabled:!W.groupId,class:"button is-white is-pulled-right",onClick:function(t){return N.executeBulkEditionProcedure(i)}},[(0,n.bo)(((0,n.uX)(),(0,n.CE)("span",U,a(e[10]||(e[10]=[(0,n.Lk)("i",{class:"has-text-dark tainacan-icon tainacan-icon-1-25em tainacan-icon-play"},null,-1)])))),[[J,{content:t.$i18n.get("label_apply_changes"),autoHide:!0,placement:"auto-end",popperClass:["tainacan-tooltip","tooltip"]}]])],8,L)):(0,n.Q3)("",!0),W.bulkEditionProcedures[i].isExecuting?((0,n.uX)(),(0,n.CE)("div",T,a(e[11]||(e[11]=[(0,n.Lk)("button",{class:"button is-white is-loading"},null,-1)])))):(0,n.Q3)("",!0)],4)])})),128))]})),_:1}),(0,n.Lk)("a",{disabled:!1===W.dones.every((function(t){return!0===t})),class:"has-text-right is-inline-block add-link",role:"button",tabindex:"0",onClick:e[2]||(e[2]=function(t){return N.addEditionCriterion()}),onKeydown:[e[3]||(e[3]=(0,n.jR)((0,n.D$)((function(t){return N.addEditionCriterion()}),["prevent"]),["enter"])),e[4]||(e[4]=(0,n.jR)((0,n.D$)((function(t){return N.addEditionCriterion()}),["prevent"]),["space"]))]},[e[12]||(e[12]=(0,n.Lk)("span",{class:"icon is-small"},[(0,n.Lk)("i",{class:"tainacan-icon has-text-secondary tainacan-icon-add"})],-1)),(0,n.eW)(" Â "+(0,n.v_)(t.$i18n.get("new_bulk_edit_criterion")),1)],40,B)]),(0,n.Lk)("footer",D,[(0,n.Lk)("p",M,[(0,n.Lk)("button",{disabled:Object.keys(W.bulkEditionProcedures).length&&W.bulkEditionProcedures[W.editionCriteria[W.editionCriteria.length-1]].isExecuting||!1,type:"button",class:"button is-outlined",onClick:e[5]||(e[5]=function(e){t.$eventBusSearch.loadItems(),t.$emit("close")})},(0,n.v_)(t.$i18n.get("close")),9,Q)]),(0,n.Lk)("p",z,[(0,n.Lk)("button",{disabled:!1===W.dones.every((function(t){return!0===t})),class:"button is-success",type:"button",onClick:e[6]||(e[6]=function(){return N.onFinish&&N.onFinish.apply(N,arguments)})},(0,n.v_)(t.$i18n.get("finish")),9,K)])])])],512)}}}]);