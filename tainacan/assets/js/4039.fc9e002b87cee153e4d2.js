(self.webpackChunktainacan=self.webpackChunktainacan||[]).push([[4039,9376],{19(t,e,a){"use strict";a.d(e,{A:()=>r.A});var r=a(83300)},19376(t,e,a){"use strict";a.r(e),a.d(e,{default:()=>i});var r=a(35517),n=a(19);a(29227);const i=(0,a(66262).A)(n.A,[["render",r.X],["__scopeId","data-v-748905a1"]])},20175(t,e,a){"use strict";a.d(e,{A:()=>s});var r=a(31601),n=a.n(r),i=a(76314),o=a.n(i)()(n());o.push([t.id,'.column[data-v-748905a1]{padding:0}.column.is-narrow[data-v-748905a1]{padding-right:42px}@keyframes enter-748905a1{from{opacity:0;transform:translate(-40px, 0)}to{opacity:1;transform:translate(0px, 0)}}form#termEditForm .tainacan-modal-content .field[data-v-748905a1]{padding-inline-start:0;margin-inline-start:0}form#termEditForm .tainacan-modal-content .tainacan-modal-title[data-v-748905a1]{padding:0 12px}form#termEditForm .tainacan-modal-content .thumbnail-field[data-v-748905a1]{max-width:120px}form#termEditForm .tainacan-modal-content .image-placeholder[data-v-748905a1]{inset-inline-start:2px}form#termEditForm .tainacan-modal-content .modal-card-body[data-v-748905a1]{padding-bottom:0px}form#termEditForm .tainacan-modal-content+.form-submit[data-v-748905a1]{background-color:var(--tainacan-gray1);position:sticky;bottom:0;padding:16px var(--tainacan-one-column);margin:0;display:flex;justify-content:space-between;z-index:2}form#termEditForm .tainacan-modal-content+.form-submit[data-v-748905a1]::after,form#termEditForm .tainacan-modal-content+.form-submit[data-v-748905a1]::before{height:calc(2*(var(--tainacan-modal-border-radius, 8px) + 2px));width:calc(2*(var(--tainacan-modal-border-radius, 8px) + 2px));background:rgba(0,0,0,0);display:block;content:"";position:absolute}form#termEditForm .tainacan-modal-content+.form-submit[data-v-748905a1]::before{left:0;top:calc(-2*(var(--tainacan-modal-border-radius, 8px) + 2px));border-bottom-left-radius:calc(var(--tainacan-modal-border-radius, 8px) + 2px);box-shadow:calc(-1*(var(--tainacan-modal-border-radius, 8px) + 2px)) 0px 0 0 var(--tainacan-gray1)}form#termEditForm .tainacan-modal-content+.form-submit[data-v-748905a1]::after{right:0;top:calc(-2*(var(--tainacan-modal-border-radius, 8px) + 2px));border-bottom-right-radius:calc(var(--tainacan-modal-border-radius, 8px) + 2px);box-shadow:calc(var(--tainacan-modal-border-radius, 8px) + 2px) 0px 0 0 var(--tainacan-gray1)}form#termEditForm .tainacan-page-title[data-v-748905a1]{display:flex;flex-wrap:wrap;align-items:baseline;margin-bottom:0}form#termEditForm .image-and-description-area[data-v-748905a1]{margin-bottom:0px}form#termEditForm .image-and-description-area .column[data-v-748905a1]:first-of-type{margin-inline-end:24px}form#termEditForm .image-and-description-area .column[data-v-748905a1]:last-of-type{flex-grow:3}form#termEditForm .thumbnail-field .content[data-v-748905a1]{padding:10px;font-size:.8em}form#termEditForm .thumbnail-field img[data-v-748905a1]{position:relative}form#termEditForm .thumbnail-field .image[data-v-748905a1],form#termEditForm .thumbnail-field img[data-v-748905a1],form#termEditForm .thumbnail-field .image-placeholder[data-v-748905a1]{border-radius:3px}form#termEditForm .thumbnail-field .image-placeholder[data-v-748905a1]{position:absolute;margin-inline-start:auto;margin-inline-end:auto;width:100%;top:35%;padding:0 8px;font-size:95%;font-weight:bold;z-index:99;text-align:center;color:var(--tainacan-info-color);background-color:rgba(0,0,0,0)}form#termEditForm .thumbnail-field .image-placeholder+img[data-v-748905a1]{opacity:.5;border:1px dashed var(--tainacan-info-color)}form#termEditForm .thumbnail-field #button-delete-header[data-v-748905a1],form#termEditForm .thumbnail-field #button-edit-header[data-v-748905a1]{border-radius:100px !important;max-height:2.125em !important;max-width:2.125em !important;min-height:2.125em !important;min-width:2.125em !important;padding:0 !important;z-index:99;margin-inline-end:10px !important}form#termEditForm .thumbnail-field #button-delete-header .icon[data-v-748905a1],form#termEditForm .thumbnail-field #button-edit-header .icon[data-v-748905a1]{color:var(--tainacan-white) !important;display:inherit;padding:0;margin:0;margin-top:-2px;font-size:1.125em}form#termEditForm .thumbnail-field .thumbnail-buttons-row[data-v-748905a1]{text-align:end;top:-0.9375em;position:relative}form#termEditForm .checkboxes-warning[data-v-748905a1]{color:var(--tainacan-gray5);font-style:italic;padding:.2em .75em}',""]);const s=o},22990(t,e,a){"use strict";var r=a(85072),n=a.n(r),i=a(97825),o=a.n(i),s=a(77659),m=a.n(s),l=a(55056),d=a.n(l),c=a(10540),h=a.n(c),u=a(63494),f=a.n(u),p=a(20175),g={};g.styleTagTransform=f(),g.setAttributes=d(),g.insert=m().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=h();n()(p.A,g),p.A&&p.A.locals&&p.A.locals},29227(t,e,a){"use strict";a(22990)},35517(t,e,a){"use strict";a.d(e,{X:()=>r.X});var r=a(85506)},38320(t,e,a){var r={"./ca":7306,"./ca.js":7306,"./el":54691,"./el.js":54691,"./en-ca":28298,"./en-ca.js":28298,"./en-gb":56195,"./en-gb.js":56195,"./en-nz":79402,"./en-nz.js":79402,"./es":97650,"./es-do":20838,"./es-do.js":20838,"./es-mx":17730,"./es-mx.js":17730,"./es-us":56575,"./es-us.js":56575,"./es.js":97650,"./fr":85498,"./fr-ca":26435,"./fr-ca.js":26435,"./fr-ch":37892,"./fr-ch.js":37892,"./fr.js":85498,"./pt":79834,"./pt-br":48303,"./pt-br.js":48303,"./pt.js":79834,"./sk":5784,"./sk.js":5784,"./sq":86794,"./sq.js":86794,"./sv":41011,"./sv.js":41011,"./uk":16618,"./uk.js":16618};function n(t){var e=i(t);return a(e)}function i(t){if(!a.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}n.keys=function(){return Object.keys(r)},n.resolve=i,t.exports=n,n.id=38320},74042(t,e,a){"use strict";a.d(e,{$J:()=>c,X3:()=>h,lg:()=>d,zt:()=>u});var r=a(75552),n=a(55373),i=a.n(n),o=a(95093),s=a.n(o);function m(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return l(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?l(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var _n=0,r=function(){};return{s:r,n:function(){return _n>=t.length?{done:!0}:{done:!1,value:t[_n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return i=t.done,t},e:function(t){o=!0,n=t},f:function(){try{i||null==a.return||a.return()}finally{if(o)throw n}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=Array(e);a<e;a++)r[a]=t[a];return r}var d={methods:{getSamplePermalink:function(t,e,a){var n={action:"tainacan-sample-permalink",post_id:t,new_title:e,new_slug:a};return"undefined"!=typeof tainacan_user&&tainacan_user.ajax_nonce&&(n._ajax_nonce=tainacan_user.ajax_nonce),r.M3.post("",i().stringify(n))}}},c={created:function(){var t=navigator.language;s().locale(t);var e=s().localeData();this.dateFormat=e.longDateFormat("L")?e.longDateFormat("L"):"pt_BR"==e._abbr?"DD/MM/YYYY":"YYYY-MM-DD",this.dateMask=this.dateFormat.replace(/[\w]/g,"0")},data:function(){return{dateFormat:"",dateMask:""}},methods:{parseDateToNavigatorLanguage:function(t){return t=new Date(t.replace(/-/g,"/")),s()(t,s().ISO_8601).format(this.dateFormat)}}},h={data:function(){return{formHooks:JSON.parse(JSON.stringify(tainacan_plugin.form_hooks)),formHookEventName:""}},computed:{hasBeginLeftForm:function(){return this.formHooks&&this.formHooks[this.entityName]&&this.formHooks[this.entityName]["begin-left"]&&this.formHooks[this.entityName]["begin-left"].length>0},hasBeginRightForm:function(){return this.formHooks&&this.formHooks[this.entityName]&&this.formHooks[this.entityName]["begin-right"]&&this.formHooks[this.entityName]["begin-right"].length>0},hasEndLeftForm:function(){return this.formHooks&&this.formHooks[this.entityName]&&this.formHooks[this.entityName]["end-left"]&&this.formHooks[this.entityName]["end-left"].length>0},hasEndRightForm:function(){return this.formHooks&&this.formHooks[this.entityName]&&this.formHooks[this.entityName]["end-right"]&&this.formHooks[this.entityName]["end-right"].length>0},getBeginLeftForm:function(){var t=this;return this.formHooks[this.entityName]["begin-left"].map((function(e){return t.checkFormConditionals(e)})).join("")},getBeginRightForm:function(){var t=this;return this.formHooks[this.entityName]["begin-right"].map((function(e){return t.checkFormConditionals(e)})).join("")},getEndLeftForm:function(){var t=this;return this.formHooks[this.entityName]["end-left"].map((function(e){return t.checkFormConditionals(e)})).join("")},getEndRightForm:function(){var t=this;return this.formHooks[this.entityName]["end-right"].map((function(e){return t.checkFormConditionals(e)})).join("")}},created:function(){this.formHookEventName="tainacan-"+this.entityName+"-hook-reload",this.formHookEvent=new Event(this.formHookEventName)},updated:function(){this.formHooks[this.entityName]&&document.dispatchEvent(this.formHookEvent)},methods:{fillExtraFormData:function(t){for(var e=0,a=["begin-left","begin-right","end-left","end-right"];e<a.length;e++){var r=a[e];if(this.formHooks[this.entityName]&&this.formHooks[this.entityName][r]&&null!=this.formHooks[this.entityName][r]){var n=document.getElementById("form-"+this.entityName+"-"+r);if(n){var i,o=m(n.elements);try{for(o.s();!(i=o.n()).done;){var s=i.value;"checkbox"==s.type||"select"==s.type&&null!=s.multiple&&1==s.multiple?s.checked&&null!=s.name&&""!=s.name&&(Array.isArray(t[s.name])||(t[s.name]=[]),t[s.name].push(s.value)):"radio"==s.type?s.checked&&null!=s.name&&""!=s.name&&(t[s.name]=s.value):t[s.name]=s.value}}catch(t){o.e(t)}finally{o.f()}}}}},updateExtraFormData:function(t){for(var e=0,a=["begin-left","begin-right","end-left","end-right"];e<a.length;e++){var r=a[e];if(this.formHooks[this.entityName]&&this.formHooks[this.entityName][r]&&null!=this.formHooks[this.entityName][r]){var n=document.getElementById("form-"+this.entityName+"-"+r);if(n){var i,o=m(n.elements);try{var s=function(){for(var e=i.value,a=0,r=Object.keys(t);a<r.length;a++){var n=r[a];if(e.name==n)if(Array.isArray(t[n])){var o=t[n].find((function(t){return t==e.value}));e.checked=null!=o}else null!=t[n]&&null!=t[n]&&""!=t[n]&&("radio"==e.type?e.checked=t[n]==e.value:e.value=t[n])}};for(o.s();!(i=o.n()).done;)s()}catch(t){o.e(t)}finally{o.f()}}}}},checkFormConditionals:function(t){if(!t.form)return"";if(!t.conditional||!Object.keys(t.conditional)||!Object.keys(t.conditional).length)return t.form;var e=t.conditional.attribute,a=t.conditional.value;if(e&&a)return this.form&&this.form[e]===a?t.form:"";for(var r=0,n=Object.keys(t.conditional);r<n.length;r++){var i=n[r];if(!this.form||!this.form[i]||this.form[i]!==t.conditional[i])return""}return t.form}}},u={props:{chartData:{},isFetchingData:!1},data:function(){return{isBuildingChart:!1,chartSeries:[],chartOptions:{}}}}},82933(t,e,a){"use strict";a.d(e,{A:()=>r});const r={attachmentControl:wp.customize.MediaControl.extend({initFrame:function(){var t=this;wp.media.view.settings.post={id:parseInt(this.params.relatedPostId),wp_customize:"off"},wp.media.model.settings.post.nonce=this.params.nonce,wp.media.model.settings.post.id=parseInt(this.params.relatedPostId),this.frame=wp.media({button:{text:this.params.button_labels.frame_button},states:[new wp.media.controller.Library({title:this.params.button_labels.frame_title,library:wp.media.query({uploadedTo:wp.media.view.settings.post.id,orderby:"menuOrder",order:"ASC",posts_per_page:-1,query:!0}),autoSelect:!0,sortable:!0,filterable:!1})]}).open(),this.frame.$el.addClass("tainacan-item-attachments-modal"),this.frame.$el["tainacan-document-id"]=this.params.document,this.frame.$el["tainacan-thumbnail-id"]=this.params.thumbnailId,wp.media.view.Attachment.Library=wp.media.view.Attachment.Library.extend({className:function(){return"attachment "+(this.controller.$el["tainacan-document-id"]&&this.model.get("id")==this.controller.$el["tainacan-document-id"]?"tainacan-document-attachment ":" ")+(this.controller.$el["tainacan-thumbnail-id"]&&this.model.get("id")==this.controller.$el["tainacan-thumbnail-id"]?"tainacan-thumbnail-attachment ":" ")}}),this.frame.on("select",(function(){var e=t.frame.state().get("selection").toJSON();wp.media.view.settings.post.id={id:t.params.relatedPostId},t.params.attachments=e,t.params.onSave(e)}))}}),thumbnailControl:wp.customize.CroppedImageControl.extend({initFrame:function(){var t=wp.media.view.l10n="undefined"==typeof _wpMediaViewsL10n?{}:_wpMediaViewsL10n,e=wp.media.controller.Cropper.extend({doCrop:function(t){var e=t.get("cropDetails"),a=this.get("control"),r=e.width/e.height;return a.params.flex_width&&a.params.flex_height?(e.dst_width=e.width,e.dst_height=e.height):(e.dst_width=a.params.flex_width?a.params.height*r:a.params.width,e.dst_height=a.params.flex_height?a.params.width/r:a.params.height),wp.ajax.post("crop-image",{wp_customize:"off",nonce:t.get("nonces").edit,id:t.get("id"),context:a.id,cropDetails:e})}});wp.media.view.settings.post={id:null},this.params.flex_width=1,this.params.flex_height=1,this.params.width=220,this.params.height=220,this.frame=wp.media({frame:"select",button:{text:t.select,close:!1},uploader:!0,content:"upload",autoSelect:!0,states:[new wp.media.controller.Library({title:this.params.button_labels.frame_title,library:wp.media.query({type:"image"}),multiple:!1,autoSelect:!0,date:!1,priority:20,suggestedWidth:this.params.width,suggestedHeight:this.params.height,uploadedTo:this.params.relatedPostId}),new e({imgSelectOptions:this.calculateImageSelectOptions,control:this})]}).open(),this.frame.$el.addClass("tainacan-thumbnail-modal"),this.frame.on("select",this.onSelect,this),this.frame.on("cropped",this.onCropped,this),this.frame.on("skippedcrop",this.onSkippedCrop,this)},setImageFromAttachment:function(t){wp.media.view.settings.post.id={id:this.params.relatedPostId},this.params.attachments=t,this.params.onSave(t)}}),headerImageControl:wp.customize.CroppedImageControl.extend({initFrame:function(){var t=wp.media.view.l10n="undefined"==typeof _wpMediaViewsL10n?{}:_wpMediaViewsL10n,e=wp.media.controller.Cropper.extend({doCrop:function(t){var e=t.get("cropDetails"),a=this.get("control"),r=e.width/e.height;return a.params.flex_width&&a.params.flex_height?(e.dst_width=e.width,e.dst_height=e.height):(e.dst_width=a.params.flex_width?a.params.height*r:a.params.width,e.dst_height=a.params.flex_height?a.params.width/r:a.params.height),wp.ajax.post("crop-image",{wp_customize:"off",nonce:t.get("nonces").edit,id:t.get("id"),context:a.id,cropDetails:e})}});wp.media.view.settings.post={id:null},null!=tainacan_plugin.custom_header_support[0]?(this.params.flex_width=tainacan_plugin.custom_header_support[0].flex_width?1:0,this.params.flex_height=tainacan_plugin.custom_header_support[0].flex_height?1:0,this.params.width=tainacan_plugin.custom_header_support[0].width,this.params.height=tainacan_plugin.custom_header_support[0].height):(this.params.flex_width=!0,this.params.flex_height=!0,this.params.width=2e3,this.params.height=625),this.frame=wp.media({frame:"select",button:{text:t.select,close:!1},library:wp.media.query({type:"image",uploadedTo:null}),uploader:!0,content:"upload",states:[new wp.media.controller.Library({title:this.params.button_labels.frame_title,library:wp.media.query({type:"image",uploadedTo:null}),multiple:!1,date:!1,priority:20,suggestedWidth:this.params.width,suggestedHeight:this.params.height}),new e({imgSelectOptions:this.calculateImageSelectOptions,control:this})]}).open(),this.frame.$el.addClass("tainacan-header-image-modal"),this.frame.on("select",this.onSelect,this),this.frame.on("cropped",this.onCropped,this),this.frame.on("skippedcrop",this.onSkippedCrop,this)},setImageFromAttachment:function(t){this.params.attachment=t,this.params.onSave(t)}}),documentFileControl:wp.customize.MediaControl.extend({initFrame:function(){var t=this;wp.media.view.settings.post={id:parseInt(this.params.relatedPostId),wp_customize:"off"},wp.media.model.settings.post.nonce=this.params.nonce,wp.media.model.settings.post.id=parseInt(this.params.relatedPostId),this.frame=wp.media({button:{text:this.params.button_labels.frame_button},content:"upload",states:[new wp.media.controller.Library({title:this.params.button_labels.frame_title,library:wp.media.query({uploadedTo:wp.media.view.settings.post.id,orderby:"menuOrder",order:"ASC",posts_per_page:-1,query:!0}),autoSelect:!0,multiple:!1,date:!1,sortable:!0,filterable:"unattached",uploadedTo:this.params.relatedPostId})]}).open(),this.frame.$el.addClass("tainacan-document-modal"),this.frame.on("select",(function(){var e,a,r=window._wpmejsSettings||{};a=t.frame.state().get("selection").first().toJSON(),t.params.attachment=a,t.params.onSave(a),(e=t.container.find("audio, video").get(0))?t.player=new MediaElementPlayer(e,r):t.cleanupPlayer()}))}})}},83300(t,e,a){"use strict";a.d(e,{A:()=>u});var r=a(6934),n=a(74042),i=a(40834),o=a(82933);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function m(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return l(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?l(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var _n=0,r=function(){};return{s:r,n:function(){return _n>=t.length?{done:!0}:{done:!1,value:t[_n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return i=t.done,t},e:function(t){o=!0,n=t},f:function(){try{i||null==a.return||a.return()}finally{if(o)throw n}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=Array(e);a<e;a++)r[a]=t[a];return r}function d(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?d(Object(a),!0).forEach((function(e){h(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function h(t,e,a){return(e=function(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,e||"default");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const u={name:"TermEditionForm",mixins:[n.X3],props:{originalForm:Object,taxonomyId:"",isHierarchical:Boolean,isTermInsertionFlow:!1,metadatumId:[String,Number],itemId:[String,Number]},emits:["on-edition-finished","close"],data:function(){return{formErrors:{},headerImageMediaFrame:void 0,isFetchingParentTerms:!1,parentTerms:[],parentTermName:"",showCheckboxesWarning:!1,hasParent:!1,hasChangedParent:!1,initialParentId:void 0,entityName:"term",isLoading:!1,parentTermSearchQuery:"",parentTermSearchOffset:0,form:{},totalTerms:void 0}},created:function(){this.form=JSON.parse(JSON.stringify(this.originalForm))},mounted:function(){var t=this;(0,r.dY)().then((function(){t.updateExtraFormData(t.form),document.getElementById("termEditForm").scrollIntoView({behavior:"smooth"})})),this.showCheckboxesWarning=!1,this.hasParent=null!=this.form.parent&&this.form.parent>0,this.initialParentId=this.form.parent,this.initializeMediaFrames(),this.hasParent&&(this.isFetchingParentTerms=!0,this.showCheckboxesWarning=!1,this.fetchParentName({taxonomyId:this.taxonomyId,parentId:this.form.parent}).then((function(e){t.parentTermName=e,t.isFetchingParentTerms=!1,t.showCheckboxesWarning=!1})).catch((function(e){t.$console.error(e),t.isFetchingParentTerms=!1,t.showCheckboxesWarning=!1})))},methods:c(c({},(0,i.i0)("taxonomy",["sendChildTerm","updateTerm","fetchParentName","fetchPossibleParentTerms"])),{},{saveEdition:function(t){var e=this;if("new"===t.id){var a={name:this.form.name,description:this.form.description,parent:this.hasParent?this.form.parent:0,header_image_id:this.form.header_image_id,header_image:this.form.header_image};this.fillExtraFormData(a),this.isLoading=!0,this.sendChildTerm({taxonomyId:this.taxonomyId,term:a,metadatumId:this.metadatumId,itemId:this.itemId}).then((function(t){e.$emit("on-edition-finished",{term:t,hasChangedParent:e.hasChangedParent,initialParent:e.initialParentId}),e.form={},e.formErrors={},e.isLoading=!1,e.$emit("close")})).catch((function(t){e.isLoading=!1;var a,r=m(t.errors);try{for(r.s();!(a=r.n()).done;)for(var n=a.value,i=0,o=Object.keys(n);i<o.length;i++){var s=o[i];Object.assign(e.formErrors,h({},s,(void 0!==e.formErrors[s]?e.formErrors[s]:"")+n[s]+"\n"))}}catch(t){r.e(t)}finally{r.f()}}))}else{var r={id:this.form.id,name:this.form.name,description:this.form.description,parent:this.hasParent?this.form.parent:0,header_image_id:this.form.header_image_id,header_image:this.form.header_image,total_children:this.form.total_children?this.form.total_children:0};this.fillExtraFormData(r),this.isLoading=!0,this.updateTerm({taxonomyId:this.taxonomyId,term:r,metadatumId:this.metadatumId,itemId:this.itemId}).then((function(t){e.formErrors={},e.$emit("on-edition-finished",{term:t,hasChangedParent:e.hasChangedParent,initialParent:e.initialParentId}),e.$emit("close")})).catch((function(t){var a,r=m(t.errors);try{for(r.s();!(a=r.n()).done;)for(var n=a.value,i=0,o=Object.keys(n);i<o.length;i++){var s=o[i];Object.assign(e.formErrors,h({},s,(void 0!==e.formErrors[s]?e.formErrors[s]:"")+n[s]+"\n"))}}catch(t){r.e(t)}finally{r.f()}e.isLoading=!1}))}},cancelEdition:function(){this.$emit("close")},deleteHeaderImage:function(){this.form=Object.assign({},this.form,{header_image_id:"0",header_image:!1})},initializeMediaFrames:function(){var t=this;this.headerImageMediaFrame=new o.A.thumbnailControl("my-thumbnail-image-media-frame",{button_labels:{frame_title:this.$i18n.get("instruction_select_term_header_image"),frame_button:this.$i18n.get("label_select_file")},relatedPostId:this.form.id,onSave:function(e){t.form=Object.assign({},t.form,{header_image_id:e.id.toString(),header_image:e.url})}})},clearErrors:function(t){if(t instanceof Object)for(var e in t)this.formErrors[e]=void 0;else this.formErrors[t]=void 0},fetchParentTerms:_.debounce((function(t){var e=this;t!=this.parentTermSearchQuery&&(this.parentTermSearchQuery=t,this.parentTerms=[],this.parentTermSearchOffset=0),t.length||(this.parentTermSearchQuery=t,this.parentTerms=[],this.parentTermSearchOffset=0),this.parentTermSearchOffset>0&&void 0!==this.totalTerms&&this.parentTerms.length>=this.totalTerms||(this.isFetchingParentTerms=!0,this.fetchPossibleParentTerms({taxonomyId:this.taxonomyId,termId:this.form.id,search:this.parentTermSearchQuery,offset:this.parentTermSearchOffset}).then((function(t){var a,r=m(t.parentTerms);try{for(r.s();!(a=r.n()).done;){var n=a.value;e.parentTerms.push(n)}}catch(t){r.e(t)}finally{r.f()}e.parentTermSearchOffset+=12,e.totalTerms=t.totalTerms,e.isFetchingParentTerms=!1})).catch((function(t){e.$console.error(t),e.isFetchingParentTerms=!1})))}),500),fetchMoreParentTerms:_.debounce((function(){this.fetchParentTerms(this.parentTermSearchQuery)}),250),onToggleSwitch:function(){0==this.form.parent?this.hasChangedParent=this.hasParent:this.hasChangedParent=!this.hasParent,this.showCheckboxesWarning=!0,this.clearErrors("parent")},onSelectParentTerm:function(t){t&&(this.hasChangedParent=this.initialParentId!=t.id,this.form.parent=t.id,this.selectedParentTerm=t,this.parentTermName=t.name,this.showCheckboxesWarning=!0)}})}},85506(t,e,a){"use strict";a.d(e,{X:()=>N});var r=a(6934);function n(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?i(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=Array(e);a<e;a++)r[a]=t[a];return r}var o={class:"tainacan-form tainacan-modal-content"},s={class:"tainacan-page-title tainacan-modal-title"},m={style:{width:"60%"}},l={class:"modal-card-body"},d={class:"label is-inline"},c=["innerHTML"],h={class:"columns is-gapless image-and-description-area"},u={class:"column"},f={class:"thumbnail-field"},p={class:"image"},g={key:0,class:"image-placeholder"},b=["alt","src"],v={class:"thumbnail-buttons-row"},y=["aria-label"],_={class:"icon is-small"},w=["aria-label"],k={class:"icon is-small"},x={class:"column"},E={class:"label"},F={class:"label is-inline"},S={class:"media"},T={key:0,class:"media-left"},I=["src"],P={class:"media-content"},C=["innerHTML"],j={class:"field is-grouped form-submit"},L={class:"control"},O={class:"control"},$={class:"button is-success",type:"submit"};function N(t,e,a,i,N,H){var A=(0,r.g2)("tainacan-external-link"),M=(0,r.g2)("b-loading"),D=(0,r.g2)("help-button"),V=(0,r.g2)("b-input"),z=(0,r.g2)("b-field"),W=(0,r.g2)("b-switch"),X=(0,r.g2)("b-autocomplete"),B=(0,r.gN)("tooltip");return(0,r.uX)(),(0,r.CE)("form",{id:"termEditForm",autofocus:"",role:"dialog",tabindex:"-1","aria-modal":"",onSubmit:e[13]||(e[13]=(0,r.D$)((function(t){return H.saveEdition(N.form)}),["prevent"]))},[(0,r.Lk)("div",o,[(0,r.Lk)("header",s,[(0,r.Lk)("h2",m,(0,r.v_)(N.form&N.form.id&&"new"!=N.form.id?t.$i18n.get("title_term_edit"):t.$i18n.get("title_term_creation")),1),N.form&&null!=N.form.url&&""!=N.form.url?((0,r.uX)(),(0,r.Wv)(A,{key:0,"link-label":t.$i18n.get("label_term_page_on_website"),"link-url":N.form.url,style:{position:"absolute",top:"0",right:"0"}},null,8,["link-label","link-url"])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",l,[(0,r.bF)(M,{modelValue:N.isLoading,"onUpdate:modelValue":e[0]||(e[0]=function(t){return N.isLoading=t}),"is-full-page":!1},null,8,["modelValue"]),(0,r.bF)(z,{addons:!1,type:""===N.formErrors.name&&""===N.formErrors.repeated||void 0===N.formErrors.name&&void 0===N.formErrors.repeated?"":"is-danger",message:N.formErrors.name?N.formErrors.name:N.formErrors.repeated},{default:(0,r.k6)((function(){return[(0,r.Lk)("label",d,[(0,r.eW)((0,r.v_)(t.$i18n.get("label_name"))+" ",1),e[14]||(e[14]=(0,r.Lk)("span",{class:"required-term-asterisk"},"*",-1)),(0,r.bF)(D,{title:t.$i18n.get("label_name"),message:t.$i18n.get("info_help_term_name"),"extra-classes":"tainacan-repository-tooltip"},null,8,["title","message"])]),(0,r.bF)(V,{modelValue:N.form.name,"onUpdate:modelValue":e[1]||(e[1]=function(t){return N.form.name=t}),placeholder:t.$i18n.get("label_term_without_name"),name:"name",onFocus:e[2]||(e[2]=function(t){return H.clearErrors({name:"name",repeated:"repeated"})})},null,8,["modelValue","placeholder"])]})),_:1},8,["type","message"]),t.hasBeginLeftForm?((0,r.uX)(),(0,r.CE)("form",{key:0,id:"form-term-begin-left",class:"form-hook-region",innerHTML:t.getBeginLeftForm},null,8,c)):(0,r.Q3)("",!0),(0,r.Lk)("div",h,[(0,r.Lk)("div",u,[(0,r.bF)(z,{addons:!1,label:t.$i18n.get("label_image")},{default:(0,r.k6)((function(){return[(0,r.Lk)("div",f,[(0,r.Lk)("figure",p,[void 0===N.form.header_image||!1===N.form.header_image?((0,r.uX)(),(0,r.CE)("span",g,(0,r.v_)(t.$i18n.get("label_empty_term_image")),1)):(0,r.Q3)("",!0),(0,r.Lk)("img",{alt:t.$i18n.get("label_image"),src:void 0===N.form.header_image||!1===N.form.header_image?t.$thumbHelper.getEmptyThumbnailPlaceholder():N.form.header_image},null,8,b)]),(0,r.Lk)("div",v,[(0,r.Lk)("a",{id:"button-edit-header",class:"button is-rounded is-secondary","aria-label":t.$i18n.get("label_button_edit_header_image"),onClick:e[3]||(e[3]=function(t){return N.headerImageMediaFrame.openFrame(t)})},[(0,r.bo)(((0,r.uX)(),(0,r.CE)("span",_,n(e[15]||(e[15]=[(0,r.Lk)("i",{class:"tainacan-icon tainacan-icon-edit"},null,-1)])))),[[B,{content:t.$i18n.get("edit"),autoHide:!0,popperClass:["tainacan-tooltip","tooltip","tainacan-repository-tooltip"],placement:"bottom"}]])],8,y),(0,r.Lk)("a",{id:"button-delete-header",class:"button is-rounded is-secondary","aria-label":t.$i18n.get("label_button_delete_thumb"),onClick:e[4]||(e[4]=function(t){return H.deleteHeaderImage()})},[(0,r.bo)(((0,r.uX)(),(0,r.CE)("span",k,n(e[16]||(e[16]=[(0,r.Lk)("i",{class:"tainacan-icon tainacan-icon-delete"},null,-1)])))),[[B,{content:t.$i18n.get("delete"),autoHide:!0,popperClass:["tainacan-tooltip","tooltip","tainacan-repository-tooltip"],placement:"bottom"}]])],8,w)])])]})),_:1},8,["label"])]),(0,r.Lk)("div",x,[(0,r.bF)(z,{addons:!1,type:""!==N.formErrors.description&&void 0!==N.formErrors.description?"is-danger":"",message:N.formErrors.description},{default:(0,r.k6)((function(){return[(0,r.Lk)("label",E,[(0,r.eW)((0,r.v_)(t.$i18n.get("label_description"))+" ",1),(0,r.bF)(D,{title:t.$i18n.get("label_description"),message:t.$i18n.get("info_help_term_description"),"extra-classes":"tainacan-repository-tooltip"},null,8,["title","message"])]),(0,r.bF)(V,{modelValue:N.form.description,"onUpdate:modelValue":e[5]||(e[5]=function(t){return N.form.description=t}),type:"textarea",name:"description",onFocus:e[6]||(e[6]=function(t){return H.clearErrors("description")})},null,8,["modelValue"])]})),_:1},8,["type","message"])])]),a.isHierarchical?((0,r.uX)(),(0,r.Wv)(z,{key:1,addons:!1,type:""===N.formErrors.parent&&""===N.formErrors.repeated||void 0===N.formErrors.parent&&void 0===N.formErrors.repeated?"":"is-danger",message:N.formErrors.parent?N.formErrors:N.formErrors.repeated},{default:(0,r.k6)((function(){return[(0,r.Lk)("label",F,[(0,r.eW)((0,r.v_)(t.$i18n.get("label_parent_term"))+" ",1),(0,r.bF)(W,{id:"tainacan-checkbox-has-parent",modelValue:N.hasParent,"onUpdate:modelValue":[e[7]||(e[7]=function(t){return N.hasParent=t}),e[8]||(e[8]=function(t){return H.onToggleSwitch()})],size:"is-small"},null,8,["modelValue"]),(0,r.bF)(D,{title:t.$i18n.get("label_parent_term"),message:t.$i18n.get("info_help_parent_term"),"extra-classes":"tainacan-repository-tooltip"},null,8,["title","message"])]),(0,r.bF)(X,{id:"tainacan-add-parent-field",modelValue:N.parentTermName,"onUpdate:modelValue":[e[9]||(e[9]=function(t){return N.parentTermName=t}),H.fetchParentTerms],placeholder:t.$i18n.get("instruction_parent_term"),data:N.parentTerms,field:"name",clearable:"",loading:N.isFetchingParentTerms,disabled:!N.hasParent,"append-to-body":!0,"check-infinite-scroll":"",onSelect:e[10]||(e[10]=function(t){return H.onSelectParentTerm(t)}),onFocus:e[11]||(e[11]=function(t){H.clearErrors("parent")}),onInfiniteScroll:H.fetchMoreParentTerms},{default:(0,r.k6)((function(t){return[(0,r.Lk)("div",S,[t.option.header_image?((0,r.uX)(),(0,r.CE)("div",T,[(0,r.Lk)("img",{width:"28",src:t.option.header_image},null,8,I)])):(0,r.Q3)("",!0),(0,r.Lk)("div",P,(0,r.v_)(t.option.name),1)])]})),empty:(0,r.k6)((function(){return[(0,r.eW)((0,r.v_)(t.$i18n.get("info_no_parent_term_found")),1)]})),_:1},8,["modelValue","placeholder","data","loading","disabled","onUpdate:modelValue","onInfiniteScroll"]),(0,r.bF)(r.eB,{name:"fade"},{default:(0,r.k6)((function(){return[(0,r.bo)((0,r.Lk)("p",{class:"checkboxes-warning"},(0,r.v_)(t.$i18n.get("info_warning_changing_parent_term")),513),[[r.aG,1!=a.isTermInsertionFlow&&1==N.showCheckboxesWarning]])]})),_:1})]})),_:1},8,["type","message"])):(0,r.Q3)("",!0),t.hasEndLeftForm?((0,r.uX)(),(0,r.CE)("form",{key:2,id:"form-term-end-left",class:"form-hook-region",innerHTML:t.getEndLeftForm},null,8,C)):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",j,[(0,r.Lk)("div",L,[(0,r.Lk)("button",{type:"button",class:"button is-outlined",onClick:e[12]||(e[12]=(0,r.D$)((function(t){return H.cancelEdition()}),["prevent"]))},(0,r.v_)(t.$i18n.get("cancel")),1)]),(0,r.Lk)("div",O,[(0,r.Lk)("button",$,(0,r.v_)(a.isTermInsertionFlow?t.$i18n.get("label_create_and_select"):t.$i18n.get("save")),1)])])],32)}}}]);