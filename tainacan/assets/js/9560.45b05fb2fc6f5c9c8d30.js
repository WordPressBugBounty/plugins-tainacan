"use strict";(self.webpackChunktainacan=self.webpackChunktainacan||[]).push([[9560],{15500(e,t,a){a.d(t,{A:()=>c});var n=a(40834);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function r(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const c={name:"ImporterEditionForm",components:{MetadatumEditionForm:a(11158).A},data:function(){return{importerId:Number,importer:null,isLoading:!1,isLoadingSourceInfo:!1,isLoadingRun:!1,mappedCollection:{id:Number,mapping:{},total_items:Number},importerType:"",importerName:"",collection:void 0,importerSourceInfo:null,collections:[],collectionMetadata:[],collectionId:void 0,isNewMetadatumModalActive:!1,isLoadingMetadatumTypes:!1,selectedMetadatumType:void 0,isEditingMetadatum:!1,metadatum:{},backgroundProcess:void 0,metadataSearchCancel:void 0,showTitlePromptModal:!1,selectedTitle:void 0,formErrorMessage:""}},computed:l(l({},(0,n.L8)("metadata",{metadatumTypes:"getMetadatumTypes"})),{},{collectionNonChildMetadata:function(){var e=this;return Array.isArray(this.collectionMetadata)?this.collectionMetadata.filter((function(t){return!e.checkIfMetadatumIsChild(t)})):[]}}),created:function(){var e=this;this.importerType=this.$route.params.importerSlug,this.sessionId=this.$route.params.sessionId,this.collectionId=this.$route.params.collectionId,this.mappedCollection.id=this.collectionId,this.fetchAvailableImporters().then((function(t){t[e.importerType]&&(e.importerName=t[e.importerType].name),e.$routerHelper.appendToPageTitle(e.importerName),wp.hooks.doAction("tainacan_navigation_path_updated",{currentRoute:e.$route,adminOptions:e.$adminOptions,parentEntity:{rootLink:"importers",name:e.importerName,defaultLink:"importers/".concat(e.importerType,"/edit"),label:e.$i18n.get("importers")}})})),this.loadImporter(),this.fetchCollectionBasics({collectionId:this.collectionId,isContextEdit:!0}).then((function(t){e.collection=t}))},beforeUnmount:function(){null!=this.metadataSearchCancel&&this.metadataSearchCancel.cancel("Metadata search Canceled.")},methods:l(l(l(l(l({},(0,n.i0)("importer",["fetchAvailableImporters","fetchImporter","sendImporter","updateImporter","updateImporterFile","updateImporterURL","updateImporterOptions","fetchImporterSourceInfo","updateImporterCollection","runImporter","fetchMappingImporter"])),(0,n.i0)("bgprocess",["fetchProcess"])),(0,n.i0)("metadata",["fetchMetadata","fetchMetadatumTypes","sendMetadatum"])),(0,n.i0)("collection",["fetchCollectionBasics"])),{},{loadImporter:function(){var e=this;this.isLoading=!0,this.formErrorMessage="",this.fetchImporter(this.sessionId).then((function(t){e.sessionId=t.id,e.importer=JSON.parse(JSON.stringify(t)),e.isLoading=!1,e.isLoadingSourceInfo=!0,e.formErrorMessage="",e.fetchImporterSourceInfo(e.sessionId).then((function(t){e.importerSourceInfo=t,e.mappedCollection.total_items=e.importerSourceInfo.source_total_items,e.isLoadingSourceInfo=!1,e.loadMetadata()})).catch((function(t){e.isLoadingSourceInfo=!1,e.formErrorMessage=t.error_message,e.$console.log(t)}))})).catch((function(t){e.$console.error(t),e.formErrorMessage=t.error_message}))},loadMetadata:function(){var e=this;this.isFetchingCollectionMetadata=!0,null!=this.metadataSearchCancel&&this.metadataSearchCancel.cancel("Metadata search Canceled."),this.fetchMetadata({collectionId:this.collectionId,isRepositoryLevel:!1,isContextEdit:!1,parent:"any"}).then((function(t){e.formErrorMessage="",t.request.then((function(t){e.collectionMetadata=JSON.parse(JSON.stringify(t)),e.isFetchingCollectionMetadata=!1,e.fetchMappingImporter({collection:e.collectionId,sessionId:e.sessionId}).then((function(t){t&&(e.mappedCollection.mapping=t)}))})).catch((function(t){e.$console.error(t),e.formErrorMessage=t.error_message,e.isFetchingCollectionMetadata=!1})),e.metadataSearchCancel=t.source})).catch((function(){return e.isFetchingCollectionMetadata=!1}))},cancelBack:function(){this.$router.go(-2)},checkIfMetadatumIsAvailable:function(e){if(null!=this.mappedCollection.mapping[e]&&null!=this.importerSourceInfo&&null!=this.importerSourceInfo){var t=this.mappedCollection.mapping[e],a=this.importerSourceInfo.source_metadata;if(a&&a.indexOf(t)>=0)return!0}return!1},checkIfChildMetadatumIsAvailable:function(e,t,a){return!!(this.mappedCollection.mapping[t]&&this.mappedCollection.mapping[t][a]&&this.mappedCollection.mapping[t][a][e]&&null!=this.importerSourceInfo&&null!=this.importerSourceInfo)},checkIfMetadatumIsCompound:function(e){return e.metadata_type_object&&e.metadata_type_object.component&&"tainacan-compound"==e.metadata_type_object.component},checkCurrentSelectedCollectionMetadatum:function(e,t){for(var a in this.mappedCollection.mapping){if(this.mappedCollection.mapping[a]==e)return a;if(t&&Object.keys(this.mappedCollection.mapping[a])&&Object.keys(this.mappedCollection.mapping[a])[0]&&Object.keys(this.mappedCollection.mapping[a])[0]==e)return a}},checkCurrentSelectedCollectionChildMetadatum:function(e,t){if(this.mappedCollection.mapping[t]&&Object.values(this.mappedCollection.mapping[t])&&Object.values(this.mappedCollection.mapping[t])[0]){var a=Object.values(this.mappedCollection.mapping[t])[0];for(var n in a)if(a[n]==e)return n}else;},checkIfMetadatumIsChild:function(e){return e.parent&&e.parent>0},getChildOfSelectedCompoundMetadata:function(e){var t=this;return this.collectionMetadata.filter((function(a){return a.parent==t.checkCurrentSelectedCollectionMetadatum(Object.entries(e)[0][0],!0)}))},onRunImporter:function(e){var t=this;if(!0!==e){var a=this.collectionMetadata.findIndex((function(e){return"Tainacan\\Metadata_Types\\Core_Title"==e.metadata_type}));if(a>=0&&this.mappedCollection&&this.mappedCollection.mapping&&!this.mappedCollection.mapping[this.collectionMetadata[a].id])return void(this.showTitlePromptModal=!0)}this.isLoadingRun=!0,this.formErrorMessage="",this.updateImporterCollection({sessionId:this.sessionId,collection:this.mappedCollection}).then((function(e){t.importer=e,t.finishRunImporter()})).catch((function(e){t.isLoadingRun=!1,t.$console.log(e),t.formErrorMessage=e.error_message}))},finishRunImporter:function(){var e=this;this.formErrorMessage="",this.runImporter(this.sessionId).then((function(t){e.backgroundProcess=t,e.isLoadingRun=!1,e.$router.push(e.$routerHelper.getProcessesPath())})).catch((function(t){e.isLoadingRun=!1,e.$console.log(t),e.formErrorMessage=t.error_message}))},onSelectCollectionChildMetadata:function(e,t,a,n){if(this.formErrorMessage="",this.mappedCollection.mapping[a]&&this.mappedCollection.mapping[a]&&this.mappedCollection.mapping[a][n]){var o=Array.isArray(this.mappedCollection.mapping[a][n])?{}:this.mappedCollection.mapping[a][n],i="";for(var l in o)o[l]==t&&(i=l);""!=i&&delete o[i],e&&(o[e]=t),this.mappedCollection.mapping[a][n]=o,this.collectionMetadata.push(""),this.collectionMetadata.pop()}},onSelectCollectionMetadata:function(e,t,a,n){this.formErrorMessage="";var o="";for(var i in this.mappedCollection.mapping)this.mappedCollection.mapping[i]==t&&(o=i),a&&Object.keys(this.mappedCollection.mapping[i])&&Object.keys(this.mappedCollection.mapping[i])[0]&&Object.keys(this.mappedCollection.mapping[i])[0]==t&&(o=i);""!=o&&delete this.mappedCollection.mapping[o];var l="";a?(l={})[t]=n:l=t,this.mappedCollection.mapping[e]=l,this.collectionMetadata.push(""),this.collectionMetadata.pop()},onSelectMetadatumType:function(e){var t=this;this.formErrorMessage="",this.sendMetadatum({collectionId:this.collectionId,name:e.name,metadatumType:e.className,status:"auto-draft",isRepositoryLevel:!1,newIndex:0}).then((function(a){t.selectedMetadatumType=e.className,t.metadatum=a,t.isEditingMetadatum=!0})).catch((function(e){t.$console.error(e)}))},createNewMetadatum:function(){var e=this;this.fetchMetadatumTypes().then((function(){e.isLoadingMetadatumTypes=!1,e.isNewMetadatumModalActive=!0})).catch((function(){e.isLoadingMetadatumTypes=!1}))},onMetadatumEditionFinished:function(){var e=this;delete this.metadatum,this.isEditingMetadatum=!1,this.isNewMetadatumModalActive=!1,this.selectedMetadatumType=void 0,this.isFetchingCollectionMetadata=!0,null!=this.metadataSearchCancel&&this.metadataSearchCancel.cancel("Metadata search Canceled."),this.fetchMetadata({collectionId:this.collectionId,isRepositoryLevel:!1,isContextEdit:!1,parent:"any"}).then((function(t){t.request.then((function(t){e.collectionMetadata=JSON.parse(JSON.stringify(t)),e.isFetchingCollectionMetadata=!1})).catch((function(t){e.$console.error(t),e.isFetchingCollectionMetadata=!1})),e.metadataSearchCancel=t.source})).catch((function(){return e.isFetchingCollectionMetadata=!1}))},onMetadatumEditionCanceled:function(){this.metadatum&&delete this.metadatum,this.isEditingMetadatum=!1,this.isNewMetadatumModalActive=!1,this.selectedMetadatumType=void 0},onConfirmTitleSelection:function(e){e.preventDefault();var t=this.collectionMetadata.findIndex((function(e){return"Tainacan\\Metadata_Types\\Core_Title"==e.metadata_type}));t>=0&&this.onSelectCollectionMetadata(this.collectionMetadata[t].id,this.importerSourceInfo.source_metadata[this.selectedTitle]),this.showTitlePromptModal=!1,this.onRunImporter()},createAllMetadata:function(){var e=this;this.mappedCollection.mapping={},this.importerSourceInfo.source_metadata.forEach((function(t,a){e.mappedCollection.mapping["create_metadata"+a]=t}))}})}},27674(e,t,a){a.d(t,{X:()=>H});var n=a(6934);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var i={class:"tainacan-repository-level-colors page-container"},l={key:0,class:"is-italic has-text-weight-semibold"},r={key:0,class:"tainacan-form tainacan-importer-mapping-form","label-width":"120px"},c={key:0},d={class:"mapping-control"},s={key:0,class:"mapping-header"},u={value:null},p=["value"],m=["value"],f=["value","disabled"],h={value:null},g=["value"],v=["value","disabled"],b={value:null},_=["value","disabled"],y={key:2},k={style:{"font-style":"italic"}},C={key:2},M={key:3},I={key:1},S={class:"field is-grouped form-submit"},L={class:"control"},x={class:"help is-danger"},E={class:"control"},w=["disabled"],O={autofocus:"true",tabindex:"-1",role:"dialog","aria-modal":""},T={class:"tainacan-modal-content"},$={class:"tainacan-modal-title tainacan-page-title tainacan-page-title--sticky"},j={class:"tainacan-form"},X={class:"metadata-types-container"},A=["onClick"],F={class:"field is-grouped form-submit"},N={class:"control"},V={class:"tainacan-modal-content tainacan-form"},P={class:"tainacan-modal-title tainacan-page-title"},Q={class:"columns"},R={class:"column"},U={style:{margin:"12px 0px 24px 0px"}},z=["value"],K={style:{"text-align":"right"},class:"column"},W={style:{"margin-top":"-24px"},class:"field is-grouped form-submit"},D={class:"control"},J={style:{"margin-left":"auto"},class:"control"},B={class:"control"},q=["disabled"];function H(e,t,a,H,G,Y){var Z=(0,n.g2)("tainacan-title"),ee=(0,n.g2)("b-loading"),te=(0,n.g2)("b-select"),ae=(0,n.g2)("b-modal"),ne=(0,n.g2)("metadatum-edition-form"),oe=(0,n.g2)("b-field");return(0,n.uX)(),(0,n.CE)("div",i,[(0,n.bF)(Z,{"is-sticky":!0},{default:(0,n.k6)((function(){return[(0,n.Lk)("h1",null,[(0,n.eW)((0,n.v_)(e.$i18n.get("title_importer_mapping_page"))+" ",1),G.importerName?((0,n.uX)(),(0,n.CE)("span",l,(0,n.v_)(G.importerName),1)):(0,n.Q3)("",!0)])]})),_:1}),(0,n.bF)(ee,{modelValue:G.isLoading,"onUpdate:modelValue":t[0]||(t[0]=function(e){return G.isLoading=e}),"can-cancel":!1},null,8,["modelValue"]),null!=G.importer&&null!=G.importer?((0,n.uX)(),(0,n.CE)("form",r,[(0,n.Lk)("p",null,(0,n.v_)(e.$i18n.get("info_metadata_mapping_helper")),1),t[26]||(t[26]=(0,n.Lk)("br",null,null,-1)),(0,n.bF)(ee,{modelValue:G.isLoadingSourceInfo,"onUpdate:modelValue":t[1]||(t[1]=function(e){return G.isLoadingSourceInfo=e}),"is-full-page":!1,"can-cancel":!1},null,8,["modelValue"]),null==G.importerSourceInfo||null==G.importerSourceInfo||G.isLoading?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",c,[(0,n.Lk)("div",d,[G.importerSourceInfo.source_metadata&&G.importerSourceInfo.source_metadata.length>0?((0,n.uX)(),(0,n.CE)("a",{key:0,style:{"margin-left":"2rem","font-size":"0.875em"},class:"is-inline is-pulled-right add-link has-text-secondary",onClick:t[2]||(t[2]=function(e){return Y.createAllMetadata()})},[t[19]||(t[19]=(0,n.Lk)("span",{"aria-hidden":"true",class:"icon"},[(0,n.Lk)("i",{class:"tainacan-icon tainacan-icon-approvedcircle"})],-1)),(0,n.eW)(" "+(0,n.v_)(e.$i18n.get("label_set_all_create_metadata")),1)])):(0,n.Q3)("",!0),null!=G.collectionId&&null!=G.collectionId&&G.importerSourceInfo.source_metadata&&G.importerSourceInfo.source_metadata.length>0&&G.collection&&G.collection.current_user_can_edit_metadata?((0,n.uX)(),(0,n.CE)("a",{key:1,style:{"font-size":"0.875em"},class:"is-inline is-pulled-right add-link has-text-secondary",onClick:t[3]||(t[3]=function(e){return Y.createNewMetadatum()})},[t[20]||(t[20]=(0,n.Lk)("span",{"aria-hidden":"true",class:"icon"},[(0,n.Lk)("i",{class:"tainacan-icon tainacan-icon-add"})],-1)),(0,n.eW)(" "+(0,n.v_)(e.$i18n.get("label_add_more_metadata")),1)])):(0,n.Q3)("",!0)]),G.importerSourceInfo.source_metadata.length>0||G.importerSourceInfo.source_special_fields&&G.importerSourceInfo.source_special_fields.length>0?((0,n.uX)(),(0,n.CE)("div",s,[(0,n.Lk)("p",null,(0,n.v_)(e.$i18n.get("label_from_source_collection")),1),t[21]||(t[21]=(0,n.Lk)("hr",null,null,-1)),t[22]||(t[22]=(0,n.Lk)("span",{"aria-hidden":"true",class:"icon"},[(0,n.Lk)("i",{class:"tainacan-icon tainacan-icon-pointer tainacan-icon-1-25em"})],-1)),t[23]||(t[23]=(0,n.Lk)("hr",null,null,-1)),(0,n.Lk)("p",null,(0,n.v_)(e.$i18n.get("label_to_target_collection")),1)])):(0,n.Q3)("",!0),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(G.importerSourceInfo.source_metadata,(function(t,a){return(0,n.uX)(),(0,n.CE)("div",{key:a,class:(0,n.C4)(["source-metadatum",{"has-children":"object"==o(t)&&Object.entries(t)[0]}])},["string"==typeof t?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.Lk)("p",null,(0,n.v_)(t),1),null!=G.collectionMetadata&&G.collectionMetadata.length>0&&!e.isFetchingCollectionMetadata?((0,n.uX)(),(0,n.Wv)(te,{key:0,"model-value":Y.checkCurrentSelectedCollectionMetadatum(t),placeholder:e.$i18n.get("label_select_metadatum"),"onUpdate:modelValue":function(e){return Y.onSelectCollectionMetadata(e,t)}},{default:(0,n.k6)((function(){return[(0,n.Lk)("option",u,(0,n.v_)(e.$i18n.get("label_select_metadatum")),1),G.collection&&G.collection.current_user_can_edit_metadata?((0,n.uX)(),(0,n.CE)("option",{key:0,value:"create_metadata"+a},(0,n.v_)(e.$i18n.get("label_create_metadatum")),9,p)):(0,n.Q3)("",!0),G.collection&&G.collection.current_user_can_edit_metadata?((0,n.uX)(),(0,n.CE)("option",{key:1,value:"create_repository_metadata"+a},(0,n.v_)(e.$i18n.get("label_create_repository_metadata")),9,m)):(0,n.Q3)("",!0),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Y.collectionNonChildMetadata,(function(a,o){return(0,n.uX)(),(0,n.CE)("option",{key:o,value:a.id,disabled:Y.checkIfMetadatumIsAvailable(a.id)||Y.checkIfMetadatumIsCompound(a)&&t.indexOf("compound|(")<0},(0,n.v_)(a.name)+" ("+(0,n.v_)(a.metadata_type_object.name)+") "+(0,n.v_)(a.collection_id!=G.collectionId?e.$i18n.get("label_inherited"):""),9,f)})),128))]})),_:2},1032,["model-value","placeholder","onUpdate:modelValue"])):(0,n.Q3)("",!0)],64)):"object"==o(t)&&Object.entries(t)[0]?((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.Lk)("p",null,(0,n.v_)(Object.entries(t)[0][0]),1),null!=G.collectionMetadata&&G.collectionMetadata.length>0&&!e.isFetchingCollectionMetadata?((0,n.uX)(),(0,n.Wv)(te,{key:0,"model-value":Y.checkCurrentSelectedCollectionMetadatum(Object.entries(t)[0][0],!0),placeholder:e.$i18n.get("label_select_metadatum"),"onUpdate:modelValue":function(e){return Y.onSelectCollectionMetadata(e,Object.entries(t)[0][0],!0,Object.entries(t)[0][1])}},{default:(0,n.k6)((function(){return[(0,n.Lk)("option",h,(0,n.v_)(e.$i18n.get("label_select_metadatum")),1),G.collection&&G.collection.current_user_can_edit_metadata?((0,n.uX)(),(0,n.CE)("option",{key:0,value:"create_metadata"+a},(0,n.v_)(e.$i18n.get("label_create_metadatum")),9,g)):(0,n.Q3)("",!0),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Y.collectionNonChildMetadata,(function(a,i){return(0,n.uX)(),(0,n.CE)("option",{key:i,value:a.id,disabled:!Y.checkIfMetadatumIsCompound(a)||Y.checkIfMetadatumIsAvailable(a.id)||"object"!=o(t)||!Object.entries(t)[0]},(0,n.v_)(a.name)+" ("+(0,n.v_)(a.metadata_type_object.name)+") "+(0,n.v_)(a.collection_id!=G.collectionId?e.$i18n.get("label_inherited"):""),9,v)})),128))]})),_:2},1032,["model-value","placeholder","onUpdate:modelValue"])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:(0,n.C4)([{"disabled-child-source-metadatum":[void 0,null,!1,"create_metadata"+a].includes(Y.checkCurrentSelectedCollectionMetadatum(Object.entries(t)[0][0],!0))},"child-source-metadatum"])},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Object.entries(t)[0][1],(function(o,i){return(0,n.uX)(),(0,n.CE)("div",{key:i,class:"source-metadatum"},[(0,n.Lk)("p",null,(0,n.v_)(o),1),null!=G.collectionMetadata&&G.collectionMetadata.length>0&&!e.isFetchingCollectionMetadata?((0,n.uX)(),(0,n.Wv)(te,{key:0,disabled:[void 0,null,!1,"create_metadata"+a].includes(Y.checkCurrentSelectedCollectionMetadatum(Object.entries(t)[0][0],!0)),"model-value":Y.checkCurrentSelectedCollectionChildMetadatum(o,Y.checkCurrentSelectedCollectionMetadatum(Object.entries(t)[0][0],!0)),placeholder:e.$i18n.get("label_select_metadatum"),"onUpdate:modelValue":function(e){return Y.onSelectCollectionChildMetadata(e,o,Y.checkCurrentSelectedCollectionMetadatum(Object.entries(t)[0][0],!0),Object.entries(t)[0][0])}},{default:(0,n.k6)((function(){return[(0,n.Lk)("option",b,(0,n.v_)(e.$i18n.get("label_select_metadatum")),1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Y.getChildOfSelectedCompoundMetadata(t),(function(a,o){return(0,n.uX)(),(0,n.CE)("option",{key:o,value:a.id,disabled:Y.checkIfChildMetadatumIsAvailable(a.id,Y.checkCurrentSelectedCollectionMetadatum(Object.entries(t)[0][0],!0),Object.entries(t)[0][0])},(0,n.v_)(a.name)+" ("+(0,n.v_)(a.metadata_type_object.name)+") "+(0,n.v_)(a.collection_id!=G.collectionId?e.$i18n.get("label_inherited"):""),9,_)})),128))]})),_:2},1032,["disabled","model-value","placeholder","onUpdate:modelValue"])):(0,n.Q3)("",!0)])})),128))],2)],64)):(0,n.Q3)("",!0),null==G.collectionMetadata||G.collectionMetadata.length<=0?((0,n.uX)(),(0,n.CE)("p",y,(0,n.v_)(e.$i18n.get("info_select_collection_to_list_metadata")),1)):(0,n.Q3)("",!0)],2)})),128)),G.importerSourceInfo.source_special_fields?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:1},(0,n.pI)(G.importerSourceInfo.source_special_fields,(function(t,a){return(0,n.uX)(),(0,n.CE)("div",{key:a,class:"source-metadatum"},[(0,n.Lk)("p",k,(0,n.v_)(t),1),(0,n.Lk)("p",null,(0,n.v_)(e.$i18n.get("info_special_fields_mapped_default")),1)])})),128)):(0,n.Q3)("",!0),G.importerSourceInfo.source_metadata.length<=0?((0,n.uX)(),(0,n.CE)("p",C,[(0,n.eW)((0,n.v_)(e.$i18n.get("info_no_metadata_source_file")),1),t[24]||(t[24]=(0,n.Lk)("br",null,null,-1))])):(0,n.Q3)("",!0),!G.importerSourceInfo.source_special_fields||G.importerSourceInfo.source_special_fields.length<=0?((0,n.uX)(),(0,n.CE)("p",M,[(0,n.eW)((0,n.v_)(e.$i18n.get("info_no_special_fields_available")),1),t[25]||(t[25]=(0,n.Lk)("br",null,null,-1))])):(0,n.Q3)("",!0)])),null==G.importerSourceInfo||null==G.importerSourceInfo?((0,n.uX)(),(0,n.CE)("div",I,[(0,n.Lk)("p",null,(0,n.v_)(e.$i18n.get("info_upload_a_source_to_see_metadata")),1)])):(0,n.Q3)("",!0),(0,n.Lk)("div",S,[(0,n.Lk)("div",L,[(0,n.Lk)("button",{id:"button-cancel-importer-mapping",class:"button is-outlined",type:"button",onClick:t[4]||(t[4]=function(){return Y.cancelBack&&Y.cancelBack.apply(Y,arguments)})},(0,n.v_)(e.$i18n.get("cancel")),1)]),(0,n.Lk)("p",x,(0,n.v_)(G.formErrorMessage),1),(0,n.Lk)("div",E,[(0,n.Lk)("button",{id:"button-submit-importer-mapping",disabled:null==e.sessionId||null==G.importer,class:(0,n.C4)([{"is-loading":G.isLoadingRun,"is-success":!G.isLoadingRun},"button"]),onClick:t[5]||(t[5]=(0,n.D$)((function(){return Y.onRunImporter&&Y.onRunImporter.apply(Y,arguments)}),["prevent"]))},(0,n.v_)(e.$i18n.get("run")),11,w)])])])):(0,n.Q3)("",!0),null!=G.selectedMetadatumType||G.isEditingMetadatum?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(ae,{key:1,modelValue:G.isNewMetadatumModalActive,"onUpdate:modelValue":t[8]||(t[8]=function(e){return G.isNewMetadatumModalActive=e}),"trap-focus":"","aria-modal":"","aria-role":"dialog",width:"420px","can-cancel":["escape","outside"],"custom-class":"tainacan-modal",onClose:t[9]||(t[9]=function(e){return Y.onMetadatumEditionCanceled()})},{default:(0,n.k6)((function(){return[(0,n.Lk)("div",O,[(0,n.bF)(ee,{modelValue:G.isLoadingMetadatumTypes,"onUpdate:modelValue":t[6]||(t[6]=function(e){return G.isLoadingMetadatumTypes=e}),"is-full-page":!1},null,8,["modelValue"]),(0,n.Lk)("div",T,[(0,n.Lk)("div",$,[(0,n.Lk)("h2",null,(0,n.v_)(e.$i18n.get("instruction_select_metadatum_type")),1)]),(0,n.Lk)("section",j,[(0,n.Lk)("div",X,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.metadatumTypes,(function(e,t){return(0,n.uX)(),(0,n.CE)("div",{key:t,class:"metadata-type",onClick:function(t){return Y.onSelectMetadatumType(e)}},[(0,n.Lk)("h4",null,(0,n.v_)(e.name),1)],8,A)})),128))]),(0,n.Lk)("div",F,[(0,n.Lk)("div",N,[(0,n.Lk)("button",{id:"button-cancel-importer-edition",class:"button is-outlined",type:"button",onClick:t[7]||(t[7]=function(e){Y.onMetadatumEditionCanceled(),G.isNewMetadatumModalActive=!1})},(0,n.v_)(e.$i18n.get("cancel")),1)])])])])])]})),_:1},8,["modelValue"])),G.selectedMetadatumType&&G.isEditingMetadatum?((0,n.uX)(),(0,n.Wv)(ae,{key:2,modelValue:G.isNewMetadatumModalActive,"onUpdate:modelValue":t[12]||(t[12]=function(e){return G.isNewMetadatumModalActive=e}),"trap-focus":"","aria-modal":"","aria-role":"dialog",width:"860px","can-cancel":["escape","outside"],"custom-class":"tainacan-modal",onClose:t[13]||(t[13]=function(e){return Y.onMetadatumEditionCanceled()})},{default:(0,n.k6)((function(){return[(0,n.bF)(ne,{"collection-id":G.collectionId,"is-repository-level":!1,index:0,"original-metadatum":G.metadatum,"is-inside-importer-flow":!0,onOnEditionFinished:t[10]||(t[10]=function(e){return Y.onMetadatumEditionFinished()}),onOnEditionCanceled:t[11]||(t[11]=function(e){return Y.onMetadatumEditionCanceled()})},null,8,["collection-id","original-metadatum"])]})),_:1},8,["modelValue"])):(0,n.Q3)("",!0),G.importerSourceInfo?((0,n.uX)(),(0,n.Wv)(ae,{key:3,modelValue:G.showTitlePromptModal,"onUpdate:modelValue":t[18]||(t[18]=function(e){return G.showTitlePromptModal=e}),"can-cancel":!1,width:820,scroll:"keep","trap-focus":"",autofocus:"",role:"dialog",tabindex:"-1","aria-modal":"","custom-class":"tainacan-modal"},{default:(0,n.k6)((function(){return[(0,n.Lk)("form",V,[(0,n.Lk)("div",P,[(0,n.Lk)("h2",null,(0,n.v_)(e.$i18n.get("instruction_select_title_mapping")),1)]),(0,n.Lk)("div",Q,[(0,n.Lk)("div",R,[(0,n.Lk)("p",U,(0,n.v_)(e.$i18n.get("info_title_mapping")),1),(0,n.bF)(oe,null,{default:(0,n.k6)((function(){return[(0,n.bF)(te,{modelValue:G.selectedTitle,"onUpdate:modelValue":t[14]||(t[14]=function(e){return G.selectedTitle=e}),expanded:"",placeholder:e.$i18n.get("label_select_metadatum")},{default:(0,n.k6)((function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(G.importerSourceInfo.source_metadata,(function(e,t){return(0,n.uX)(),(0,n.CE)("option",{key:t,value:t},(0,n.v_)(e),9,z)})),128))]})),_:1},8,["modelValue","placeholder"])]})),_:1})]),(0,n.Lk)("div",K,[((0,n.uX)(),(0,n.CE)(n.FK,null,(0,n.pI)(4,(function(a){return(0,n.Lk)("div",{key:a,class:"item-demo"},[(0,n.Lk)("p",null,(0,n.v_)(""==G.selectedTitle||null==G.selectedTitle?e.$i18n.get("label_title"):G.importerSourceInfo.source_metadata[G.selectedTitle]),1),t[27]||(t[27]=(0,n.Lk)("div",null,null,-1))])})),64))])]),(0,n.Lk)("div",W,[(0,n.Lk)("div",D,[(0,n.Lk)("button",{class:"button is-outlined",type:"button",onClick:t[15]||(t[15]=function(e){G.selectedTitle="",G.showTitlePromptModal=!1})},(0,n.v_)(e.$i18n.get("cancel")),1)]),(0,n.Lk)("div",J,[(0,n.Lk)("button",{class:"button is-secondary",type:"button",onClick:t[16]||(t[16]=function(e){G.selectedTitle="",G.showTitlePromptModal=!1,Y.onRunImporter(!0)})},(0,n.v_)(e.$i18n.get("skip")),1)]),(0,n.Lk)("div",B,[(0,n.Lk)("button",{type:"submit",class:"button is-success",disabled:""===G.selectedTitle||null==G.selectedTitle,onClick:t[17]||(t[17]=function(){return Y.onConfirmTitleSelection&&Y.onConfirmTitleSelection.apply(Y,arguments)})},(0,n.v_)(e.$i18n.get("apply")),9,q)])])])]})),_:1},8,["modelValue"])):(0,n.Q3)("",!0)])}},29560(e,t,a){a.r(t),a.d(t,{default:()=>i});var n=a(77293),o=a(40043);a(62683);const i=(0,a(66262).A)(o.A,[["render",n.X],["__scopeId","data-v-637fa16e"]])},40043(e,t,a){a.d(t,{A:()=>n.A});var n=a(15500)},62683(e,t,a){a(63102)},63102(e,t,a){var n=a(85072),o=a.n(n),i=a(97825),l=a.n(i),r=a(77659),c=a.n(r),d=a(55056),s=a.n(d),u=a(10540),p=a.n(u),m=a(63494),f=a.n(m),h=a(93559),g={};g.styleTagTransform=f(),g.setAttributes=s(),g.insert=c().bind(null,"head"),g.domAPI=l(),g.insertStyleElement=p();o()(h.A,g),h.A&&h.A.locals&&h.A.locals},77293(e,t,a){a.d(t,{X:()=>n.X});var n=a(27674)},93559(e,t,a){a.d(t,{A:()=>r});var n=a(31601),o=a.n(n),i=a(76314),l=a.n(i)()(o());l.push([e.id,'.field[data-v-637fa16e]{position:relative}.tainacan-importer-mapping-form[data-v-637fa16e]{display:flex;flex-direction:column;justify-content:space-between;min-height:247px;padding-top:var(--tainacan-container-padding)}.tainacan-importer-mapping-form .form-submit[data-v-637fa16e]{margin-top:24px;position:sticky !important;bottom:0;background:var(--tainacan-background-color, white);z-index:9;padding:12px;border-top:1px solid var(--tainacan-gray3);box-shadow:0 -5px 12px -14px var(--tainacan-gray5)}.tainacan-importer-mapping-form .section-label[data-v-637fa16e]{font-size:1em !important;font-weight:500 !important;color:var(--tainacan-blue5) !important;line-height:1.2em}.source-metadatum[data-v-637fa16e]{padding:2px 0;min-height:35px;width:calc(100% - 32px);margin:3px 16px 6px 16px;display:flex;justify-content:space-between;align-items:center;position:relative}.source-metadatum[data-v-637fa16e]::before{display:block;content:"";position:absolute;height:1px;width:100%;background-color:var(--tainacan-gray2);z-index:0}.source-metadatum>p[data-v-637fa16e]{font-weight:normal;transition:font-weight .1s ease;padding-right:6px;overflow:hidden;word-wrap:break-word;background-color:var(--tainacan-background-color, white);z-index:1}.source-metadatum .control[data-v-637fa16e]{max-width:60%}.source-metadatum:hover>.control[data-v-637fa16e]{--tainacan-input-border-color: var(--tainacan-gray4)}.source-metadatum[data-v-637fa16e]:hover::before{background-color:var(--tainacan-gray4)}.source-metadatum:hover>p[data-v-637fa16e]{font-weight:bold}.source-metadatum.has-children[data-v-637fa16e]{flex-wrap:wrap}.source-metadatum.has-children[data-v-637fa16e]::before{top:1rem}.child-source-metadatum[data-v-637fa16e]{flex-basis:100%;border-inline-start:1px solid var(--tainacan-gray2);padding-inline-start:1em;opacity:1;transition:border-inline-start .2s ease,opacity .2s ease}.child-source-metadatum .source-metadatum[data-v-637fa16e]{border-bottom:none;margin-bottom:0;margin-top:2px;padding-top:8px;padding-bottom:0px}.child-source-metadatum.disabled-child-source-metadatum[data-v-637fa16e]{border-inline-start:1px solid var(--tainacan-gray1);opacity:.7}.is-inline .control[data-v-637fa16e]{display:inline}.drop-inner[data-v-637fa16e]{padding:1em 3em}.mapping-control[data-v-637fa16e]{background-color:var(--tainacan-background-color, white);position:sticky;top:-34px;z-index:9;height:2.5rem;padding-top:12px}.mapping-header[data-v-637fa16e]{background-color:var(--tainacan-background-color, white);position:sticky;top:0;z-index:9;width:100%;display:flex;justify-content:space-between;align-items:center;color:var(--tainacan-info-color);font-size:.875em;font-weight:bold;margin:0 0 12px 0;border-bottom:1px solid var(--tainacan-gray3);box-shadow:0 5px 12px -14px var(--tainacan-gray5)}.mapping-header p[data-v-637fa16e]{white-space:nowrap}.mapping-header hr[data-v-637fa16e]{width:100%;margin-left:12px;margin-right:12px;height:1px;background:linear-gradient(90deg, #f2f2f2, #dbdbdb, #f2f2f2)}@media screen and (max-width: 768px){.mapping-header p[data-v-637fa16e]{white-space:normal}.mapping-header hr[data-v-637fa16e]{display:none}}.tainacan-modal .animation-content[data-v-637fa16e]{width:100%;z-index:99999}.tainacan-modal .animation-content #metadatumEditForm[data-v-637fa16e]{background-color:var(--tainacan-background-color)}.metadata-types-container .metadata-type[data-v-637fa16e]{border-bottom:1px solid var(--tainacan-gray2);padding:15px calc(2*var(--tainacan-one-column));cursor:pointer}.metadata-types-container .metadata-type[data-v-637fa16e]:first-child{margin-top:15px}.metadata-types-container .metadata-type[data-v-637fa16e]:last-child{border-bottom:none}.metadata-types-container .metadata-type[data-v-637fa16e]:hover{background-color:var(--tainacan-gray1)}.item-demo[data-v-637fa16e]{display:inline-block;margin:8px 12px}.item-demo p[data-v-637fa16e]{max-width:74px;font-size:.875em;color:var(--tainacan-gray5);margin:4px 8px;text-align:start;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.item-demo div[data-v-637fa16e]{height:90px;width:90px;background-color:var(--tainacan-gray2);border-radius:2px}',""]);const r=l}}]);